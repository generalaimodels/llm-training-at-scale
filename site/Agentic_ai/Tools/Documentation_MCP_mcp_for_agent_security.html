<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Chapter 2: Tools — Comprehensive SOTA Reference">
  <title>Chapter 2: Tools — Comprehensive SOTA Reference | AI Engineering Knowledge Hub</title>
  <script>
  (() => {
    try {
      const key = "docs-theme-mode";
      const raw = window.localStorage.getItem(key);
      const mode = raw === "graphite" || raw === "ivory" ? raw : "ivory";
      document.documentElement.dataset.theme = mode;
      document.documentElement.style.colorScheme = mode === "graphite" ? "dark" : "light";
    } catch {
      document.documentElement.dataset.theme = "ivory";
      document.documentElement.style.colorScheme = "light";
    }
  })();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="../../assets/vendor/katex/katex.min.css?v=2026-02-19T19%3A13%3A56.962Z">
  <link rel="stylesheet" href="../../assets/styles.css?v=2026-02-19T19%3A13%3A56.962Z">
</head>
<body>
  <div class="ambient-layer ambient-layer-a" aria-hidden="true"></div>
  <div class="ambient-layer ambient-layer-b" aria-hidden="true"></div>
  <header class="topbar">
    <button id="menu-toggle" class="icon-btn" type="button" aria-label="Toggle navigation">Menu</button>
    <a class="brand" href="../../index.html">
      <span class="brand-kicker">Docs</span>
      <strong>AI Engineering Knowledge Hub</strong>
    </a>
    <div class="topbar-actions">
      <input id="nav-filter" class="doc-filter" type="search" placeholder="Filter documents" aria-label="Filter documents">
      <p id="filter-status" class="filter-status" aria-live="polite"></p>
      <button id="theme-toggle" class="icon-btn" type="button" aria-label="Switch theme">Graphite</button>
    </div>
  </header>
  <div class="site-shell">
    <aside class="nav-pane" id="left-nav">
      <p class="pane-label">Source Folder</p>
      <p class="pane-title">llm_training_at_scale</p>
      <nav class="doc-nav" aria-label="Document list">
<a class="doc-link" data-doc-link data-doc-title="1.10 advanced prompt chaining techniques" data-doc-path="agentic_ai/advanced_prompt_chaining_techniques" data-doc-folder="agentic_ai" href="../../Agentic_ai/Advanced_prompt_chaining_techniques.html"><span>1.10 Advanced Prompt Chaining Techniques</span><small>Agentic_ai/Advanced_prompt_chaining_techniques</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 1: prompt chaining" data-doc-path="agentic_ai/architecture_and_design_patterns_of_prompt_chains" data-doc-folder="agentic_ai" href="../../Agentic_ai/Architecture_and_design_patterns_of_prompt_chains.html"><span>Chapter 1: Prompt Chaining</span><small>Agentic_ai/Architecture_and_design_patterns_of_prompt_chains</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.7 error handling, robustness, and fault tolerance" data-doc-path="agentic_ai/error_handling_robustness_and_fault_tolerance" data-doc-folder="agentic_ai" href="../../Agentic_ai/Error_handling_robustness_and_fault_tolerance.html"><span>1.7 Error Handling, Robustness, and Fault Tolerance</span><small>Agentic_ai/Error_handling_robustness_and_fault_tolerance</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.13 evaluation of prompt chains" data-doc-path="agentic_ai/evaluation_of_prompt_chains" data-doc-folder="agentic_ai" href="../../Agentic_ai/Evaluation_of_prompt_chains.html"><span>1.13 Evaluation of Prompt Chains</span><small>Agentic_ai/Evaluation_of_prompt_chains</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 1: prompt chaining — comprehensive treatment" data-doc-path="agentic_ai/foundations_of_prompt_chaining" data-doc-folder="agentic_ai" href="../../Agentic_ai/Foundations_of_prompt_chaining.html"><span>Chapter 1: Prompt Chaining — Comprehensive Treatment</span><small>Agentic_ai/Foundations_of_prompt_chaining</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.9 optimization of prompt chains" data-doc-path="agentic_ai/optimization_of_prompt_chains" data-doc-folder="agentic_ai" href="../../Agentic_ai/Optimization_of_prompt_chains.html"><span>1.9 Optimization of Prompt Chains</span><small>Agentic_ai/Optimization_of_prompt_chains</small></a>
<a class="doc-link" data-doc-link data-doc-title="prompt chaining: frameworks, observability, evaluation, security, applications, and paradigm comparisons" data-doc-path="agentic_ai/prompt chaining_frameworks_and_implementation" data-doc-folder="agentic_ai" href="../../Agentic_ai/Prompt Chaining_frameworks_and_Implementation.html"><span>Prompt Chaining: Frameworks, Observability, Evaluation, Security, Applications, and Paradigm Comparisons</span><small>Agentic_ai/Prompt Chaining_frameworks_and_Implementation</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 1: prompt chaining — comprehensive index" data-doc-path="agentic_ai/prompt_chaining_index" data-doc-folder="agentic_ai" href="../../Agentic_ai/Prompt_Chaining_index.html"><span>Chapter 1: Prompt Chaining — Comprehensive Index</span><small>Agentic_ai/Prompt_Chaining_index</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.16 prompt chaining vs. related paradigms" data-doc-path="agentic_ai/prompt_chaining_vs_related_paradigm" data-doc-folder="agentic_ai" href="../../Agentic_ai/Prompt_chaining_vs_related_paradigm.html"><span>1.16 Prompt Chaining vs. Related Paradigms</span><small>Agentic_ai/Prompt_chaining_vs_related_paradigm</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 1: prompt chaining" data-doc-path="agentic_ai/prompt_design_for_chain_steps" data-doc-folder="agentic_ai" href="../../Agentic_ai/Prompt_design_for_chain_steps.html"><span>Chapter 1: Prompt Chaining</span><small>Agentic_ai/Prompt_design_for_chain_steps</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.15 real-world applications and case studies" data-doc-path="agentic_ai/real-world_applications_and_case_studies" data-doc-folder="agentic_ai" href="../../Agentic_ai/Real-World_applications_and_case_studies.html"><span>1.15 Real-World Applications and Case Studies</span><small>Agentic_ai/Real-World_applications_and_case_studies</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.6 routing and conditional logic in chains" data-doc-path="agentic_ai/routing_and_conditional_logic_in_chains" data-doc-folder="agentic_ai" href="../../Agentic_ai/Routing_and_conditional_logic_in_chains.html"><span>1.6 Routing and Conditional Logic in Chains</span><small>Agentic_ai/Routing_and_conditional_logic_in_chains</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.14 security, safety, and guardrails in prompt chains" data-doc-path="agentic_ai/security_safety_and_guardrails_in_prompt_chaind" data-doc-folder="agentic_ai" href="../../Agentic_ai/Security_safety_and_guardrails_in_prompt_chaind.html"><span>1.14 Security, Safety, and Guardrails in Prompt Chains</span><small>Agentic_ai/Security_safety_and_guardrails_in_prompt_chaind</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.4 state management and context propagation" data-doc-path="agentic_ai/state_management_and_context_propagation" data-doc-folder="agentic_ai" href="../../Agentic_ai/State_management_and_context_propagation.html"><span>1.4 State Management and Context Propagation</span><small>Agentic_ai/State_management_and_context_propagation</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.5 task decomposition strategies" data-doc-path="agentic_ai/task_decomposition_strategies" data-doc-folder="agentic_ai" href="../../Agentic_ai/Task_decomposition_strategies.html"><span>1.5 Task Decomposition Strategies</span><small>Agentic_ai/Task_decomposition_strategies</small></a>
<a class="doc-link is-active" data-doc-link data-doc-title="chapter 2: tools — comprehensive sota reference" data-doc-path="agentic_ai/tools/documentation_mcp_mcp_for_agent_security" data-doc-folder="agentic_ai/tools" href="../../Agentic_ai/Tools/Documentation_MCP_mcp_for_agent_security.html"><span>Chapter 2: Tools — Comprehensive SOTA Reference</span><small>Agentic_ai/Tools/Documentation_MCP_mcp_for_agent_security</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 2: tools — comprehensive sota reference" data-doc-path="agentic_ai/tools/introduction_tools_action" data-doc-folder="agentic_ai/tools" href="../../Agentic_ai/Tools/Introduction_Tools_Action.html"><span>Chapter 2: Tools — Comprehensive SOTA Reference</span><small>Agentic_ai/Tools/Introduction_Tools_Action</small></a>
<a class="doc-link" data-doc-link data-doc-title="2.6 security in mcp" data-doc-path="agentic_ai/tools/security_mcp_conclusion" data-doc-folder="agentic_ai/tools" href="../../Agentic_ai/Tools/Security_MCP_conclusion.html"><span>2.6 Security in MCP</span><small>Agentic_ai/Tools/Security_MCP_conclusion</small></a>
<a class="doc-link" data-doc-link data-doc-title="chapter 2: tools — comprehensive sota index" data-doc-path="agentic_ai/tools/tools_comprehensive_index" data-doc-folder="agentic_ai/tools" href="../../Agentic_ai/Tools/Tools_comprehensive_Index.html"><span>Chapter 2: Tools — Comprehensive SOTA Index</span><small>Agentic_ai/Tools/Tools_comprehensive_Index</small></a>
<a class="doc-link" data-doc-link data-doc-title="1.8 verification, validation, and quality control" data-doc-path="agentic_ai/verification_validation_and_quality_control" data-doc-folder="agentic_ai" href="../../Agentic_ai/Verification_validation_and_quality_control.html"><span>1.8 Verification, Validation, and Quality Control</span><small>Agentic_ai/Verification_validation_and_quality_control</small></a>
<a class="doc-link" data-doc-link data-doc-title="context parallelism and ring attention" data-doc-path="context_parallelism_update" data-doc-folder="root" href="../../context_parallelism_update.html"><span>Context Parallelism and Ring Attention</span><small>context_parallelism_update</small></a>
<a class="doc-link" data-doc-link data-doc-title="tensor parallelism (tp) and sequence parallelism (sp)" data-doc-path="context_parallelism" data-doc-folder="root" href="../../context_parallelism.html"><span>Tensor Parallelism (TP) and Sequence Parallelism (SP)</span><small>context_parallelism</small></a>
<a class="doc-link" data-doc-link data-doc-title="data parallelism: a comprehensive technical treatment" data-doc-path="data_parallelism_basic" data-doc-folder="root" href="../../data_parallelism_basic.html"><span>Data Parallelism: A Comprehensive Technical Treatment</span><small>data_parallelism_basic</small></a>
<a class="doc-link" data-doc-link data-doc-title="data parallelism (dp): a comprehensive technical treatment" data-doc-path="data_parallelism" data-doc-folder="root" href="../../data_parallelism.html"><span>Data Parallelism (DP): A Comprehensive Technical Treatment</span><small>data_parallelism</small></a>
<a class="doc-link" data-doc-link data-doc-title="finding the best training configuration for distributed large model training" data-doc-path="distributed_large_model_training" data-doc-folder="root" href="../../distributed_large_model_training.html"><span>Finding the Best Training Configuration for Distributed Large Model Training</span><small>distributed_large_model_training</small></a>
<a class="doc-link" data-doc-link data-doc-title="diving into the gpus — fusing, threading, and mixing" data-doc-path="diving_gpus_fusing_threading_and_mixing" data-doc-folder="root" href="../../diving_gpus_fusing_threading_and_mixing.html"><span>Diving into the GPUs — Fusing, Threading, and Mixing</span><small>diving_gpus_fusing_threading_and_mixing</small></a>
<a class="doc-link" data-doc-link data-doc-title="expert parallelism and 5d parallelism: a comprehensive technical treatment" data-doc-path="expert_parallelism_update" data-doc-folder="root" href="../../expert_parallelism_update.html"><span>Expert Parallelism and 5D Parallelism: A Comprehensive Technical Treatment</span><small>expert_parallelism_update</small></a>
<a class="doc-link" data-doc-link data-doc-title="expert parallelism and 5d parallelism: a comprehensive technical treatment" data-doc-path="expert_parallelism" data-doc-folder="root" href="../../expert_parallelism.html"><span>Expert Parallelism and 5D Parallelism: A Comprehensive Technical Treatment</span><small>expert_parallelism</small></a>
<a class="doc-link" data-doc-link data-doc-title="scaling distributed training: foundations and first principles" data-doc-path="high_level_overview_updated" data-doc-folder="root" href="../../high_level_overview_updated.html"><span>Scaling Distributed Training: Foundations and First Principles</span><small>high_level_overview_updated</small></a>
<a class="doc-link" data-doc-link data-doc-title="high-level overview of distributed training: foundations, memory analysis, and first-step techniques" data-doc-path="high_level_overview" data-doc-folder="root" href="../../high_level_overview.html"><span>High-Level Overview of Distributed Training: Foundations, Memory Analysis, and First-Step Techniques</span><small>high_level_overview</small></a>
<a class="doc-link" data-doc-link data-doc-title="pipeline parallelism: comprehensive technical exposition" data-doc-path="pipelineparallelism_update" data-doc-folder="root" href="../../pipelineparallelism_update.html"><span>Pipeline Parallelism: Comprehensive Technical Exposition</span><small>pipelineparallelism_update</small></a>
<a class="doc-link" data-doc-link data-doc-title="pipeline parallelism: a comprehensive technical exposition" data-doc-path="pipelineparallelism" data-doc-folder="root" href="../../pipelineparallelism.html"><span>Pipeline Parallelism: A Comprehensive Technical Exposition</span><small>pipelineparallelism</small></a>
<a class="doc-link" data-doc-link data-doc-title="tensor parallelism (tp) and sequence parallelism (sp)" data-doc-path="tensor_parallelism_update" data-doc-folder="root" href="../../tensor_parallelism_update.html"><span>Tensor Parallelism (TP) and Sequence Parallelism (SP)</span><small>tensor_parallelism_update</small></a>
<a class="doc-link" data-doc-link data-doc-title="tensor parallelism (tp) and sequence parallelism (sp)" data-doc-path="tensor_parallelism" data-doc-folder="root" href="../../tensor_parallelism.html"><span>Tensor Parallelism (TP) and Sequence Parallelism (SP)</span><small>tensor_parallelism</small></a>
      </nav>
    </aside>
    <main class="content-pane">
      <article class="doc-content">
<h1 id="chapter-2-tools-comprehensive-sota-reference" tabindex="-1">Chapter 2: Tools — Comprehensive SOTA Reference</h1>
<h2 id="24-understanding-the-model-context-protocol-mcp" tabindex="-1">2.4 Understanding the Model Context Protocol (MCP)</h2>
<hr>
<h3 id="241-the-n-m-integration-problem-and-the-need-for-standardization" tabindex="-1">2.4.1 The “N × M” Integration Problem and the Need for Standardization</h3>
<h4 id="2411-the-combinatorial-explosion-problem" tabindex="-1">2.4.1.1 The Combinatorial Explosion Problem</h4>
<p>Every modern AI system that aspires to agentic behavior must interface with external tools—databases, APIs, file systems, code interpreters, search engines, and domain-specific services. The fundamental integration challenge arises from a simple combinatorial reality.</p>
<p><strong>Formal Problem Statement.</strong> Let <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>denote the number of distinct AI applications (hosts/clients)—Claude Desktop, ChatGPT, a custom LangChain agent, an IDE copilot, a customer-support bot—and let<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>denote the number of distinct tool/service providers—GitHub, Slack, PostgreSQL, a weather API, a code sandbox. Without any standardization layer, connecting every application to every tool requires building a bespoke, point-to-point connector for each<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mi>p</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi><mi>o</mi><mi>o</mi><msub><mi>l</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(application_i, tool_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ppl</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">oo</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></eq> pair. The total number of unique integration artifacts is:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>C</mi><mtext>naive</mtext></msub><mo>=</mo><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">
C_{\text{naive}} = N \times M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">naive</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eqn></section><p>Each connector must handle:</p>
<ol>
<li><strong>Schema translation</strong> — converting the tool’s native API schema into the format the AI application’s function-calling interface expects.</li>
<li><strong>Authentication plumbing</strong> — managing API keys, OAuth tokens, or session cookies specific to that tool for that application.</li>
<li><strong>Error mapping</strong> — translating tool-specific error codes into the host application’s error-handling paradigm.</li>
<li><strong>Data serialization</strong> — marshalling inputs and unmarshalling outputs between the AI application’s internal representation and the tool’s wire format.</li>
<li><strong>Lifecycle management</strong> — handling connection setup, health checking, reconnection, and teardown.</li>
</ol>
<p><strong>Growth dynamics.</strong> As either <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>or<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq> increases, the integration surface grows multiplicatively:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mtext>naive</mtext></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>N</mi></mrow></mfrac><mo>=</mo><mi>M</mi><mo separator="true">,</mo><mspace width="2em"/><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mtext>naive</mtext></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>M</mi></mrow></mfrac><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial C_{\text{naive}}}{\partial N} = M, \qquad \frac{\partial C_{\text{naive}}}{\partial M} = N
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">naive</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">naive</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></eqn></section><p>Adding a single new AI application requires <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>new connectors; adding a single new tool requires<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>new connectors. In a realistic enterprise with<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">N = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></eq>applications and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">M = 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50</span></span></span></span></eq>services, this yields<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>500</mn></mrow><annotation encoding="application/x-tex">500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">500</span></span></span></span></eq> bespoke connectors—each requiring independent development, testing, versioning, and maintenance.</p>
<p><strong>Maintenance amplification.</strong> When tool <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></eq>updates its API (e.g., a breaking schema change, endpoint deprecation, or authentication protocol migration), all<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>connectors to that tool must be updated simultaneously. Conversely, when application<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></eq> upgrades its function-calling format (e.g., OpenAI migrating from <code>functions</code> to <code>tools</code> parameter format), all <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>connectors from that application must be refactored. The total maintenance events per API change scale as<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></eq>or<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></eq> respectively, making the system operationally fragile at scale.</p>
<p><strong>Analogy: USB standardization.</strong> Prior to the Universal Serial Bus (USB) standard, peripheral manufacturers had to build device-specific interfaces for each computer platform (serial ports, parallel ports, proprietary connectors). USB collapsed this <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>matrix into<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>+</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N + M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>: each computer implements one USB host controller, each peripheral implements one USB device interface. MCP aims to achieve an identical architectural simplification for AI-tool connectivity.</p>
<hr>
<h4 id="2412-pre-mcp-integration-landscape" tabindex="-1">2.4.1.2 Pre-MCP Integration Landscape</h4>
<p>Before MCP, the AI-tool integration ecosystem consisted of multiple incompatible, partially overlapping approaches, each creating its own integration silo.</p>
<p><strong>Provider-Specific Function Calling Formats</strong></p>
<p>Each LLM provider defined its own proprietary schema for tool/function specification:</p>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Format Name</th>
<th>Schema Location</th>
<th>Key Differences</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenAI</td>
<td><code>tools</code> array with <code>function</code> type</td>
<td>Request body parameter</td>
<td>Uses <code>strict</code> mode for constrained decoding; <code>function_call</code> → <code>tool_choice</code> migration</td>
</tr>
<tr>
<td>Anthropic</td>
<td><code>tools</code> array</td>
<td>Request body parameter</td>
<td>Uses <code>cache_control</code> annotations; <code>tool_use</code> content blocks</td>
</tr>
<tr>
<td>Google (Gemini)</td>
<td><code>function_declarations</code> in <code>tools</code></td>
<td>Nested within <code>tool_config</code></td>
<td>Uses <code>function_calling_config</code> with mode enum</td>
</tr>
<tr>
<td>Cohere</td>
<td><code>tools</code> array</td>
<td>Request body parameter</td>
<td>Supports <code>parameter_definitions</code> with custom types</td>
</tr>
<tr>
<td>Mistral</td>
<td><code>tools</code> array</td>
<td>OpenAI-compatible but divergent edge cases</td>
<td>Partial OpenAI compatibility with subtle schema deviations</td>
</tr>
</tbody>
</table>
<p>Each format prescribes slightly different JSON structures for identical semantic content: the tool’s name, description, and parameter schema. A tool developer who wants their service accessible across all providers must maintain separate schema definitions and result-parsing logic for each.</p>
<p><strong>Framework-Specific Tool Abstractions</strong></p>
<p>Orchestration frameworks introduced their own abstraction layers, further fragmenting the ecosystem:</p>
<ul>
<li><strong>LangChain</strong> — <code>BaseTool</code> class with <code>_run()</code> / <code>_arun()</code> methods; <code>ToolMessage</code> type; tool schemas derived via Pydantic model introspection.</li>
<li><strong>LlamaIndex</strong> — <code>FunctionTool</code> / <code>QueryEngineTool</code> wrappers; tools embedded within <code>AgentRunner</code> abstractions.</li>
<li><strong>AutoGen</strong> — <code>register_for_llm()</code> / <code>register_for_execution()</code> decorators; tool registration tied to agent conversation protocols.</li>
<li><strong>CrewAI</strong> — <code>@tool</code> decorator; tool definitions coupled to crew/task configuration YAML.</li>
<li><strong>Semantic Kernel (Microsoft)</strong> — <code>KernelFunction</code> with plugin architecture; OpenAPI-based tool import.</li>
</ul>
<p>Each framework defines its own tool interface, registration mechanism, invocation protocol, and result format. A tool written for LangChain cannot be used in CrewAI without a translation layer.</p>
<p><strong>Impedance Mismatch</strong></p>
<p>The term <em>impedance mismatch</em>—borrowed from electrical engineering where it describes the inefficiency of power transfer between circuits of differing impedance—precisely characterizes this situation. Translating between tool formats requires:</p>
<ul>
<li>Schema transformers (e.g., LangChain <code>ToolMessage</code> → OpenAI <code>tool</code> response format)</li>
<li>Result adapters (e.g., converting Anthropic <code>tool_result</code> content blocks into LlamaIndex <code>ToolOutput</code>)</li>
<li>Error code mapping tables</li>
<li>Authentication credential forwarding across abstraction boundaries</li>
</ul>
<p>Each translation layer introduces potential information loss, subtle behavioral differences, and additional failure modes.</p>
<p><strong>Maintenance Burden</strong></p>
<p>The total engineering cost can be modeled as:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Cost</mtext><mtext>total</mtext></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><mo fence="true">(</mo><msubsup><mi>c</mi><mtext>dev</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>c</mi><mtext>test</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>c</mi><mtext>maintain</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>⋅</mo><mi>T</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{Cost}_{\text{total}} = \sum_{i=1}^{N} \sum_{j=1}^{M} \left( c_{\text{dev}}^{(i,j)} + c_{\text{test}}^{(i,j)} + c_{\text{maintain}}^{(i,j)} \cdot T \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Cost</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2421em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dev</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4173em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">maintain</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2827em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></eqn></section><p>where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mtext>dev</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">c_{\text{dev}}^{(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dev</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span></eq>is the one-time development cost,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mtext>test</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">c_{\text{test}}^{(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2906em;vertical-align:-0.2458em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span></span></eq>is the testing cost,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mtext>maintain</mtext><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">c_{\text{maintain}}^{(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3275em;vertical-align:-0.2827em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4173em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">maintain</span></span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2827em;"><span></span></span></span></span></span></span></span></span></span></eq>is the per-period maintenance cost, and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></eq>is the time horizon. This sum scales as<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>⋅</mo><mi>M</mi><mo>⋅</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N \cdot M \cdot T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></eq>, making it economically unsustainable for large ecosystems.</p>
<hr>
<h4 id="2413-the-standardization-solution" tabindex="-1">2.4.1.3 The Standardization Solution</h4>
<p>MCP eliminates the combinatorial explosion by introducing a single, shared protocol interface between applications and tools.</p>
<p><strong>Architectural Reduction</strong></p>
<p>With MCP, each of the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>applications implements exactly one MCP client, and each of the<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq> tools implements exactly one MCP server. The total number of integration artifacts becomes:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>C</mi><mtext>MCP</mtext></msub><mo>=</mo><mi>N</mi><mo>+</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">
C_{\text{MCP}} = N + M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eqn></section><p>The improvement ratio is:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msub><mi>C</mi><mtext>naive</mtext></msub><msub><mi>C</mi><mtext>MCP</mtext></msub></mfrac><mo>=</mo><mfrac><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><mrow><mi>N</mi><mo>+</mo><mi>M</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac{C_{\text{naive}}}{C_{\text{MCP}}} = \frac{N \times M}{N + M}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">naive</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mi>M</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">N = M = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>, this simplifies to <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msup><mi>k</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>k</mi></mrow></mfrac><mo>=</mo><mfrac><mi>k</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{k^2}{2k} = \frac{k}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3629em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0179em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></eq>, meaning the standardized approach is <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>k</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{k}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></eq>-times more efficient. For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10</mn><mo separator="true">,</mo><mi>M</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N = 10, M = 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50</span></span></span></span></eq>:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mn>10</mn><mo>×</mo><mn>50</mn></mrow><mrow><mn>10</mn><mo>+</mo><mn>50</mn></mrow></mfrac><mo>=</mo><mfrac><mn>500</mn><mn>60</mn></mfrac><mo>≈</mo><mn>8.3</mn><mo>×</mo><mtext> reduction</mtext></mrow><annotation encoding="application/x-tex">
\frac{10 \times 50}{10 + 50} = \frac{500}{60} \approx 8.3\times \text{ reduction}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">50</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">50</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">60</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">500</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">8.3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord"> reduction</span></span></span></span></span></span></eqn></section><p><strong>Protocol-Level Interoperability</strong></p>
<p>Any MCP-compliant client can connect to any MCP-compliant server without custom integration code. This is achieved through:</p>
<ol>
<li><strong>Uniform wire protocol</strong> — JSON-RPC 2.0 over standardized transports (stdio, HTTP+SSE, Streamable HTTP).</li>
<li><strong>Standardized primitive types</strong> — Tools, Resources, Prompts, Sampling, Elicitation defined with fixed schema contracts.</li>
<li><strong>Capability negotiation</strong> — clients and servers dynamically discover each other’s supported features during connection initialization.</li>
<li><strong>Schema-driven tool discovery</strong> — tools self-describe via JSON Schema input specifications, enabling any client to construct valid invocations.</li>
</ol>
<p><strong>Open Specification</strong></p>
<p>MCP is published as an open specification (not proprietary to any single vendor), enabling:</p>
<ul>
<li>Community-driven evolution via public RFC process</li>
<li>Vendor-neutral governance</li>
<li>Multiple independent implementations (reference SDKs exist in TypeScript and Python)</li>
<li>Third-party conformance testing and validation</li>
<li>Ecosystem-wide interoperability guarantees</li>
</ul>
<hr>
<h4 id="2414-historical-precedents-for-standardization" tabindex="-1">2.4.1.4 Historical Precedents for Standardization</h4>
<p>MCP does not exist in a vacuum; it draws from a lineage of successful standardization protocols that solved analogous <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq> problems in other domains.</p>
<p><strong>Language Server Protocol (LSP)</strong></p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>LSP</th>
<th>MCP</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Problem</strong></td>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>IDEs ×<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>programming languages =<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>language support plugins</td>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></eq>AI apps ×<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>tools =<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq> tool connectors</td>
</tr>
<tr>
<td><strong>Solution</strong></td>
<td>Standardized protocol between editors and language servers</td>
<td>Standardized protocol between AI hosts and tool servers</td>
</tr>
<tr>
<td><strong>Wire Format</strong></td>
<td>JSON-RPC 2.0</td>
<td>JSON-RPC 2.0</td>
</tr>
<tr>
<td><strong>Architecture</strong></td>
<td>Client (IDE) ↔ Server (language analyzer)</td>
<td>Client (AI host) ↔ Server (tool provider)</td>
</tr>
<tr>
<td><strong>Capability Negotiation</strong></td>
<td><code>initialize</code> handshake with <code>capabilities</code> exchange</td>
<td><code>initialize</code> handshake with <code>capabilities</code> exchange</td>
</tr>
<tr>
<td><strong>Key Innovation</strong></td>
<td>Separated editor UX from language analysis</td>
<td>Separated AI orchestration from tool implementation</td>
</tr>
</tbody>
</table>
<p>MCP’s design is directly inspired by LSP. The <code>initialize</code> / <code>initialized</code> handshake pattern, the capability negotiation structure, and the use of JSON-RPC 2.0 as the wire format are all borrowed from LSP. The key conceptual difference: LSP enables code intelligence features (completion, diagnostics, refactoring) across editors, while MCP enables tool invocation across AI applications.</p>
<p><strong>ODBC/JDBC</strong></p>
<p>Open Database Connectivity (ODBC) and Java Database Connectivity (JDBC) standardized database access across applications and database engines. Before ODBC, each application needed database-specific drivers. ODBC introduced:</p>
<ul>
<li>A driver manager as the mediation layer (analogous to the MCP host)</li>
<li>Standardized SQL wire protocol (analogous to JSON-RPC in MCP)</li>
<li>Driver-based extensibility (analogous to MCP servers)</li>
</ul>
<p>MCP borrows the concept of <strong>driver-based extensibility</strong>: just as a new database only needs one ODBC driver to be accessible by all ODBC-compliant applications, a new tool only needs one MCP server to be accessible by all MCP-compliant hosts.</p>
<p><strong>OpenAPI / Swagger</strong></p>
<p>OpenAPI provides a machine-readable description of REST API endpoints, enabling automatic client generation, documentation, and testing. MCP’s tool definition schema (name, description, JSON Schema input) serves an analogous role: it provides a machine-readable tool description that enables AI models to understand tool capabilities and construct valid invocations.</p>
<p>However, MCP goes beyond OpenAPI in several ways:</p>
<ul>
<li><strong>Bidirectional communication</strong> — OpenAPI describes one-way client→server API calls; MCP supports server→client communication (sampling, elicitation, notifications).</li>
<li><strong>Stateful sessions</strong> — OpenAPI describes stateless REST endpoints; MCP maintains stateful sessions with capability negotiation.</li>
<li><strong>AI-native design</strong> — MCP tool descriptions include <code>annotations</code> (destructive, idempotent, read-only hints) specifically designed for AI model reasoning, which OpenAPI does not natively provide.</li>
<li><strong>Multi-primitive model</strong> — OpenAPI describes only API endpoints; MCP defines multiple primitive types (tools, resources, prompts) with different access control semantics.</li>
</ul>
<hr>
<h3 id="242-core-architectural-components-hosts-clients-and-servers" tabindex="-1">2.4.2 Core Architectural Components: Hosts, Clients, and Servers</h3>
<h4 id="2421-architecture-overview" tabindex="-1">2.4.2.1 Architecture Overview</h4>
<p>The MCP architecture follows a three-tier model with strict separation of concerns:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs">┌──────────────────────────────────────────────────────────────┐
│                      HOST APPLICATION                        │
│  (Claude Desktop, IDE Copilot, Custom Agent, etc.)           │
│                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  MCP Client  │  │  MCP Client  │  │  MCP Client  │       │
│  │  (session 1) │  │  (session 2) │  │  (session 3) │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                 │                 │                │
│  ┌──────┴─────────────────┴─────────────────┴──────┐         │
│  │            Host Orchestration Layer              │         │
│  │  (Security policy, consent UI, model routing)    │         │
│  └──────────────────────────────────────────────────┘         │
└─────────┼─────────────────┼─────────────────┼────────────────┘
          │ stdio           │ HTTP+SSE        │ Streamable HTTP
   ┌──────▼───────┐  ┌──────▼───────┐  ┌──────▼───────┐
   │  MCP Server  │  │  MCP Server  │  │  MCP Server  │
   │  (local:     │  │  (remote:    │  │  (remote:    │
   │   filesystem)│  │   GitHub API)│  │   database)  │
   └──────────────┘  └──────────────┘  └──────────────┘
</code></pre>
</div><p><strong>Key architectural invariants:</strong></p>
<ol>
<li>
<p><strong>One client per server</strong> — Each MCP client maintains exactly one session with exactly one MCP server. This 1:1 mapping ensures session isolation, simplifies state management, and provides security boundaries.</p>
</li>
<li>
<p><strong>Many clients per host</strong> — A single host application can instantiate multiple MCP clients, each connecting to a different server. The host orchestrates across all clients.</p>
</li>
<li>
<p><strong>Host as trust root</strong> — The host application is the ultimate authority for security decisions: which servers to connect to, which tool calls to approve, what data to expose, and what sampling requests to honor.</p>
</li>
<li>
<p><strong>Server as capability provider</strong> — Servers expose capabilities (tools, resources, prompts) but do not initiate unsolicited actions. The two exceptions—sampling and elicitation—are explicitly server-initiated <em>requests</em> that the host may approve or deny.</p>
</li>
</ol>
<hr>
<h4 id="2422-host" tabindex="-1">2.4.2.2 Host</h4>
<p><strong>Definition.</strong> The host is the user-facing AI application that orchestrates the end-to-end interaction between the user, the language model, and external tools. Examples include Claude Desktop, VS Code Copilot extensions, custom agentic applications built with orchestration frameworks, and enterprise AI platforms.</p>
<p><strong>Responsibilities:</strong></p>
<table>
<thead>
<tr>
<th>Responsibility</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>User Interaction</strong></td>
<td>Rendering chat interfaces, displaying tool results, managing conversation history, and presenting consent dialogs for tool invocations</td>
</tr>
<tr>
<td><strong>Model Invocation</strong></td>
<td>Sending prompts to the LLM (local or API-based), managing context windows, and handling model responses including tool-call decisions</td>
</tr>
<tr>
<td><strong>Client Orchestration</strong></td>
<td>Instantiating MCP clients, managing their lifecycles, routing tool calls to the appropriate client, and aggregating results</td>
</tr>
<tr>
<td><strong>Security Policy Enforcement</strong></td>
<td>Deciding which MCP servers to connect to, what permissions to grant each server, whether to approve tool calls (especially destructive ones), and what data to expose via sampling</td>
</tr>
<tr>
<td><strong>Context Assembly</strong></td>
<td>Aggregating tool descriptions from all connected servers, formatting them for the model’s function-calling interface, and injecting tool results back into the conversation context</td>
</tr>
<tr>
<td><strong>Consent Management</strong></td>
<td>Presenting human-in-the-loop approval dialogs for sensitive operations, managing user preferences for auto-approval of low-risk actions</td>
</tr>
</tbody>
</table>
<p><strong>Host as the trust boundary.</strong> This is the most critical architectural principle. The host is the only component that:</p>
<ul>
<li>Has direct access to the user (can request consent)</li>
<li>Has direct access to the model (controls what context the model sees)</li>
<li>Knows the full set of connected servers (can enforce cross-server policies)</li>
<li>Can enforce rate limits, spending caps, and operational boundaries</li>
</ul>
<p>Servers cannot bypass the host’s security policies. Even when a server requests sampling (asking the host to run LLM inference), the host retains full control over whether to honor the request, what model to use, and whether to modify the request before execution.</p>
<hr>
<h4 id="2423-client" tabindex="-1">2.4.2.3 Client</h4>
<p><strong>Definition.</strong> An MCP client is a protocol-layer component that lives inside the host application and manages a single, stateful connection to one MCP server. The client handles all protocol mechanics: transport management, JSON-RPC message serialization/deserialization, capability negotiation, and session state tracking.</p>
<p><strong>Responsibilities:</strong></p>
<table>
<thead>
<tr>
<th>Responsibility</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Protocol Negotiation</strong></td>
<td>Executing the <code>initialize</code> → <code>initialized</code> handshake, exchanging protocol versions and capabilities</td>
</tr>
<tr>
<td><strong>Capability Exchange</strong></td>
<td>Advertising client capabilities (e.g., support for sampling, roots, elicitation) and recording server capabilities (e.g., which primitives the server supports)</td>
</tr>
<tr>
<td><strong>Message Routing</strong></td>
<td>Serializing outbound requests (<code>tools/call</code>, <code>resources/read</code>, etc.) and dispatching inbound responses/notifications to appropriate handlers</td>
</tr>
<tr>
<td><strong>Lifecycle Management</strong></td>
<td>Managing connection establishment, health monitoring (ping/pong), reconnection after failures, and graceful shutdown</td>
</tr>
<tr>
<td><strong>Session State</strong></td>
<td>Maintaining the set of negotiated capabilities, tracking outstanding request IDs, managing subscription state for resources</td>
</tr>
</tbody>
</table>
<p><strong>Isolation property.</strong> Each client is isolated from other clients within the same host. This design ensures:</p>
<ul>
<li><strong>Fault isolation</strong> — If one MCP server crashes, only its corresponding client is affected; other clients continue operating normally.</li>
<li><strong>Security isolation</strong> — A compromised server cannot access data flowing through other client connections.</li>
<li><strong>State isolation</strong> — Each client maintains independent session state; there is no shared mutable state between clients.</li>
</ul>
<p><strong>Client vs. Host distinction.</strong> The client is a protocol-level construct; the host is an application-level construct. The host contains business logic (user interaction, model invocation, policy enforcement), while the client contains only protocol mechanics. This separation enables:</p>
<ul>
<li>Reusable MCP client libraries (SDK implementations) shared across different host applications</li>
<li>Host-specific customization without modifying protocol handling</li>
<li>Testability: clients can be tested against mock servers independently of host logic</li>
</ul>
<hr>
<h4 id="2424-server" tabindex="-1">2.4.2.4 Server</h4>
<p><strong>Definition.</strong> An MCP server is a lightweight process or service that exposes tools, resources, and/or prompts to MCP clients. The server wraps existing functionality—an API, a database, a filesystem, a computation engine—behind the standardized MCP interface.</p>
<p><strong>Responsibilities:</strong></p>
<table>
<thead>
<tr>
<th>Responsibility</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Capability Advertisement</strong></td>
<td>Responding to <code>initialize</code> with the set of supported primitives (tools, resources, prompts, etc.)</td>
</tr>
<tr>
<td><strong>Tool Exposure</strong></td>
<td>Responding to <code>tools/list</code> with tool definitions; executing <code>tools/call</code> requests and returning structured results</td>
</tr>
<tr>
<td><strong>Resource Exposure</strong></td>
<td>Responding to <code>resources/list</code> and <code>resources/read</code>; managing subscriptions and sending update notifications</td>
</tr>
<tr>
<td><strong>Prompt Exposure</strong></td>
<td>Responding to <code>prompts/list</code> and <code>prompts/get</code> with parameterized prompt templates</td>
</tr>
<tr>
<td><strong>Request Handling</strong></td>
<td>Validating incoming requests against declared schemas, executing the requested operation, and formatting results per the MCP content model</td>
</tr>
</tbody>
</table>
<p><strong>Server deployment topologies:</strong></p>
<p><strong>Local servers (stdio transport):</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">Host Process
  ├── MCP Client ──stdio──▶ MCP Server (child process)
  │                         ├── reads from stdin
  │                         └── writes to stdout
  └── (server runs as subprocess with inherited permissions)
</code></pre>
</div><ul>
<li>The host spawns the server as a child process.</li>
<li>Communication occurs over the child process’s stdin/stdout streams.</li>
<li>The server inherits the host process’s filesystem permissions and environment variables.</li>
<li>Use cases: local file operations, code execution, development tools.</li>
<li>Advantages: zero network configuration, low latency, simple security model (process-level sandboxing).</li>
<li>Limitations: cannot serve multiple hosts; tightly coupled to host process lifecycle.</li>
</ul>
<p><strong>Remote servers (HTTP+SSE or Streamable HTTP transport):</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">Host Process                              Network
  ├── MCP Client ──HTTP POST──▶ ┌──────────────────┐
  │              ◀──SSE stream── │  MCP Server      │
  │                              │  (remote service) │
  └──                            └──────────────────┘
</code></pre>
</div><ul>
<li>The server runs as an independent network service (potentially on a different machine, in a container, or in the cloud).</li>
<li>Client → Server: HTTP POST requests carrying JSON-RPC messages.</li>
<li>Server → Client: Server-Sent Events (SSE) stream for push notifications and streaming responses.</li>
<li>Use cases: shared tool services, cloud-hosted APIs, multi-tenant environments.</li>
<li>Advantages: can serve multiple hosts simultaneously, independent scaling, remote deployment.</li>
<li>Requirements: network configuration, TLS, authentication, CORS handling.</li>
</ul>
<p><strong>Server lifecycle state machine:</strong></p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Uninitialized</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext mathvariant="monospace">initialize</mtext></mpadded></mover><mtext>Initializing</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext mathvariant="monospace">initialized</mtext></mpadded></mover><mtext>Operational</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow><mtext mathvariant="monospace">shutdown</mtext><mtext> </mtext><mtext mathvariant="monospace">/</mtext><mtext> </mtext><mtext mathvariant="monospace">disconnect</mtext></mrow></mpadded></mover><mtext>Terminated</mtext></mrow><annotation encoding="application/x-tex">
\text{Uninitialized} \xrightarrow{\texttt{initialize}} \text{Initializing} \xrightarrow{\texttt{initialized}} \text{Operational} \xrightarrow{\texttt{shutdown / disconnect}} \text{Terminated}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0608em;vertical-align:-0.011em;"></span><span class="mord text"><span class="mord">Uninitialized</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0498em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord texttt mtight">initialize</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2442em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Initializing</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0498em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord texttt mtight">initialized</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3025em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Operational</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord texttt mtight">shutdown / disconnect</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Terminated</span></span></span></span></span></span></eqn></section><table>
<thead>
<tr>
<th>State</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Uninitialized</strong></td>
<td>Server is started but has not received <code>initialize</code>. Rejects all requests except <code>initialize</code>.</td>
</tr>
<tr>
<td><strong>Initializing</strong></td>
<td>Server has received <code>initialize</code>, is preparing capabilities. Sends <code>initialize</code> response with capabilities.</td>
</tr>
<tr>
<td><strong>Operational</strong></td>
<td>Server has received <code>initialized</code> notification. Accepts all supported request types.</td>
</tr>
<tr>
<td><strong>Terminated</strong></td>
<td>Connection closed. Server releases resources and may exit.</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="2425-capability-negotiation" tabindex="-1">2.4.2.5 Capability Negotiation</h4>
<p>The capability negotiation mechanism ensures that clients and servers can interoperate even when they support different subsets of the protocol’s features.</p>
<p><strong>Negotiation flow:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">Client                                    Server
  │                                         │
  │──── initialize ────────────────────────▶│
  │     {                                   │
  │       protocolVersion: &quot;2025-06-18&quot;,    │
  │       capabilities: {                   │
  │         sampling: {},                   │
  │         roots: { listChanged: true }    │
  │       },                                │
  │       clientInfo: {                     │
  │         name: &quot;MyAgent&quot;, version: &quot;1.0&quot; │
  │       }                                 │
  │     }                                   │
  │                                         │
  │◀─── initialize response ───────────────│
  │     {                                   │
  │       protocolVersion: &quot;2025-06-18&quot;,    │
  │       capabilities: {                   │
  │         tools: { listChanged: true },   │
  │         resources: {                    │
  │           subscribe: true,              │
  │           listChanged: true             │
  │         },                              │
  │         prompts: { listChanged: true }  │
  │       },                                │
  │       serverInfo: {                     │
  │         name: &quot;GitHubServer&quot;,           │
  │         version: &quot;2.1&quot;                  │
  │       }                                 │
  │     }                                   │
  │                                         │
  │──── initialized (notification) ────────▶│
  │                                         │
  │     [Session is now operational]        │
</code></pre>
</div><p><strong>Capability categories:</strong></p>
<p><em>Client capabilities</em> (advertised by the client, consumed by the server):</p>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sampling</code></td>
<td>Client supports <code>sampling/createMessage</code> requests from the server</td>
</tr>
<tr>
<td><code>roots</code></td>
<td>Client provides filesystem roots; <code>listChanged</code> indicates dynamic root updates</td>
</tr>
<tr>
<td><code>elicitation</code></td>
<td>Client supports <code>elicitation/create</code> requests from the server</td>
</tr>
</tbody>
</table>
<p><em>Server capabilities</em> (advertised by the server, consumed by the client):</p>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tools</code></td>
<td>Server exposes callable tools; <code>listChanged</code> indicates dynamic tool set updates</td>
</tr>
<tr>
<td><code>resources</code></td>
<td>Server exposes readable resources; <code>subscribe</code> enables change subscriptions; <code>listChanged</code> indicates dynamic resource set updates</td>
</tr>
<tr>
<td><code>prompts</code></td>
<td>Server exposes prompt templates; <code>listChanged</code> indicates dynamic prompt set updates</td>
</tr>
<tr>
<td><code>logging</code></td>
<td>Server supports structured log emission</td>
</tr>
</tbody>
</table>
<p><strong>Progressive capability discovery.</strong> After the handshake, the client adapts its behavior based on the server’s declared capabilities:</p>
<ul>
<li>If the server does not declare <code>tools</code>, the client will not send <code>tools/list</code> or <code>tools/call</code>.</li>
<li>If the server declares <code>resources.subscribe: true</code>, the client knows it can register for resource change notifications.</li>
<li>If the client does not declare <code>sampling</code>, the server will not attempt to send <code>sampling/createMessage</code>.</li>
</ul>
<p><strong>Version negotiation.</strong> The <code>protocolVersion</code> field follows a date-based versioning scheme (e.g., <code>&quot;2025-06-18&quot;</code>). The negotiation rule:</p>
<ul>
<li>The client proposes the latest protocol version it supports.</li>
<li>The server responds with a version it supports that is ≤ the client’s proposed version.</li>
<li>If no compatible version exists, the server rejects the connection.</li>
</ul>
<p>This ensures <strong>backward compatibility</strong>: a newer client can connect to an older server (which will respond with an older protocol version), and the client degrades gracefully to the older feature set.</p>
<p><strong>Forward compatibility.</strong> Unknown capabilities in the negotiation response are ignored (not treated as errors). This allows older clients to connect to newer servers that advertise capabilities the client does not understand—the client simply does not use those capabilities.</p>
<hr>
<h3 id="243-the-communication-layer-json-rpc-transports-and-message-types" tabindex="-1">2.4.3 The Communication Layer: JSON-RPC, Transports, and Message Types</h3>
<h4 id="2431-json-rpc-20-as-the-wire-protocol" tabindex="-1">2.4.3.1 JSON-RPC 2.0 as the Wire Protocol</h4>
<p>MCP adopts JSON-RPC 2.0 as its wire protocol—the format and semantics of individual messages exchanged between client and server.</p>
<p><strong>Why JSON-RPC 2.0?</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Benefit for MCP</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Simplicity</strong></td>
<td>Minimal specification (4 pages); trivial to implement in any language</td>
</tr>
<tr>
<td><strong>Language agnosticism</strong></td>
<td>JSON is universally supported; no language-specific serialization dependencies</td>
</tr>
<tr>
<td><strong>Stateless message format</strong></td>
<td>Each message is self-contained; transport-agnostic</td>
</tr>
<tr>
<td><strong>Wide tooling support</strong></td>
<td>Mature libraries in Python, TypeScript, Go, Rust, Java, etc.</td>
</tr>
<tr>
<td><strong>Proven track record</strong></td>
<td>Used by LSP, Ethereum JSON-RPC, and numerous other protocols</td>
</tr>
<tr>
<td><strong>Request-response + notification model</strong></td>
<td>Supports both bidirectional RPC and fire-and-forget notifications</td>
</tr>
</tbody>
</table>
<p><strong>Message structures:</strong></p>
<p><strong>Request</strong> (expects a response):</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tools/call&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;search_github&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;arguments&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MCP specification&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;max_results&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><ul>
<li><code>jsonrpc</code>: Protocol version identifier (always <code>&quot;2.0&quot;</code>)</li>
<li><code>id</code>: Request identifier (integer or string); used to correlate responses with requests</li>
<li><code>method</code>: The RPC method name (MCP defines specific method names for each operation)</li>
<li><code>params</code>: Method-specific parameters (object or array)</li>
</ul>
<p><strong>Response</strong> (success):</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Found 3 repositories matching &#x27;MCP specification&#x27;...&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;isError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><ul>
<li><code>id</code>: Matches the request’s <code>id</code> for correlation</li>
<li><code>result</code>: Method-specific result payload</li>
</ul>
<p><strong>Error response:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-32602</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Invalid params: &#x27;max_results&#x27; must be a positive integer&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;max_results&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;received&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-5</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><ul>
<li><code>error.code</code>: Numeric error code (JSON-RPC defines standard codes; MCP may extend)</li>
<li><code>error.message</code>: Human-readable error description</li>
<li><code>error.data</code>: Optional structured error details</li>
</ul>
<p><strong>Notification</strong> (no response expected):</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;notifications/tools/list_changed&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><ul>
<li>No <code>id</code> field — this is the distinguishing characteristic of notifications</li>
<li>The sender does not expect or wait for a response</li>
<li>Used for events: tool list changes, resource updates, progress updates, cancellation</li>
</ul>
<p><strong>Standard JSON-RPC error codes used by MCP:</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32700</mn></mrow><annotation encoding="application/x-tex">-32700</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32700</span></span></span></span></eq></td>
<td>Parse error</td>
<td>Server received invalid JSON</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32600</mn></mrow><annotation encoding="application/x-tex">-32600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32600</span></span></span></span></eq></td>
<td>Invalid request</td>
<td>JSON is valid but not a valid JSON-RPC request</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32601</mn></mrow><annotation encoding="application/x-tex">-32601</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32601</span></span></span></span></eq></td>
<td>Method not found</td>
<td>The requested method does not exist or is not supported</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32602</mn></mrow><annotation encoding="application/x-tex">-32602</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32602</span></span></span></span></eq></td>
<td>Invalid params</td>
<td>Method parameters are invalid (type mismatch, missing required fields)</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32603</mn></mrow><annotation encoding="application/x-tex">-32603</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32603</span></span></span></span></eq></td>
<td>Internal error</td>
<td>Unspecified server-side error during method execution</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="2432-transport-mechanisms" tabindex="-1">2.4.3.2 Transport Mechanisms</h4>
<p>The transport layer defines <em>how</em> JSON-RPC messages are physically delivered between client and server. MCP defines three transport mechanisms, each optimized for different deployment scenarios.</p>
<p><strong>Stdio Transport</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">┌────────────┐     stdin (JSON-RPC messages, newline-delimited)
│   Host     │ ──────────────────────────────────────────────▶ ┌─────────────┐
│ (MCP Client│ ◀────────────────────────────────────────────── │ MCP Server  │
│  inside)   │     stdout (JSON-RPC messages, newline-delimited│ (child proc)│
└────────────┘                                                 └─────────────┘
               stderr: reserved for diagnostic logging (not protocol messages)
</code></pre>
</div><p><strong>Mechanism:</strong></p>
<ul>
<li>The host spawns the MCP server as a child process (e.g., <code>subprocess.Popen</code> in Python, <code>child_process.spawn</code> in Node.js).</li>
<li>Messages from client to server are written to the child process’s <code>stdin</code>.</li>
<li>Messages from server to client are read from the child process’s <code>stdout</code>.</li>
<li>Each message is a single line of JSON (newline-delimited JSON, NDJSON).</li>
<li><code>stderr</code> is reserved for human-readable diagnostic logs; it is NOT part of the protocol.</li>
</ul>
<p><strong>Message framing:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;method&quot;:&quot;tools/list&quot;,&quot;params&quot;:{}}\n
{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:{&quot;tools&quot;:[...]}}\n
</code></pre>
</div><p>Each JSON-RPC message is terminated by a newline character (<code>\n</code>). The receiver reads line by line, parsing each line as a complete JSON-RPC message.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Latency</strong>: Minimal (inter-process communication, no network stack).</li>
<li><strong>Security</strong>: Server inherits the host process’s user permissions, environment variables, and filesystem access. No network exposure.</li>
<li><strong>Lifecycle coupling</strong>: Server lifetime is bound to the host process. When the host exits, the server’s stdin is closed, signaling shutdown.</li>
<li><strong>Concurrency</strong>: Single connection; multiplexing achieved via JSON-RPC <code>id</code> correlation.</li>
<li><strong>Use cases</strong>: Local development tools, filesystem access, code execution sandboxes, desktop applications.</li>
</ul>
<p><strong>HTTP + Server-Sent Events (SSE) Transport</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">┌────────────┐                                    ┌─────────────┐
│   Host     │ ── HTTP POST (JSON-RPC request) ──▶│ MCP Server  │
│ (MCP Client│ ◀── HTTP Response (JSON-RPC resp)──│ (remote svc)│
│  inside)   │                                    │             │
│            │ ◀── SSE stream (notifications) ────│             │
└────────────┘                                    └─────────────┘
</code></pre>
</div><p><strong>Mechanism:</strong></p>
<ul>
<li>Client → Server communication: Standard HTTP POST requests, each carrying a JSON-RPC message in the request body.</li>
<li>Server → Client communication (push): Server-Sent Events (SSE) stream. The client opens a long-lived HTTP connection to the server’s SSE endpoint; the server pushes notifications and streaming results as SSE events.</li>
<li>Request-response correlation: The client sends a POST request and receives the JSON-RPC response in the HTTP response body.</li>
</ul>
<p><strong>SSE event format:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs">event: message
data: {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;notifications/resources/updated&quot;,&quot;params&quot;:{&quot;uri&quot;:&quot;file:///data.csv&quot;}}

event: message
data: {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;notifications/progress&quot;,&quot;params&quot;:{&quot;progressToken&quot;:&quot;abc&quot;,&quot;progress&quot;:50,&quot;total&quot;:100}}
</code></pre>
</div><p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Latency</strong>: Network-dependent; typically 1-100ms for cloud services.</li>
<li><strong>Security</strong>: Supports TLS (HTTPS), authentication headers (Bearer tokens, API keys), CORS policies.</li>
<li><strong>Lifecycle</strong>: Server is independently deployed; connection lifecycle managed by HTTP keep-alive and SSE reconnection.</li>
<li><strong>Concurrency</strong>: Multiple concurrent POST requests supported; SSE stream handles all server-initiated messages.</li>
<li><strong>Use cases</strong>: Cloud-hosted tool services, shared team tools, multi-tenant deployments.</li>
</ul>
<p><strong>Streamable HTTP Transport (Newer Specification)</strong></p>
<p>The Streamable HTTP transport unifies the request-response and streaming patterns into a single HTTP-based mechanism:</p>
<ul>
<li>Client sends HTTP POST requests with JSON-RPC messages.</li>
<li>Server can respond with either:
<ul>
<li>A single JSON-RPC response (standard HTTP response body)</li>
<li>A streaming response (chunked transfer encoding or SSE within the response body)</li>
</ul>
</li>
<li>Server-initiated messages are delivered via a dedicated SSE endpoint or via response streaming.</li>
<li>Supports session affinity via <code>Mcp-Session-Id</code> header for stateful connections.</li>
</ul>
<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Simplification</strong>: Eliminates the need for separate SSE endpoint management.</li>
<li><strong>Session management</strong>: Explicit session IDs enable load-balanced deployments with session affinity.</li>
<li><strong>Compatibility</strong>: Works with standard HTTP infrastructure (proxies, load balancers, CDNs).</li>
<li><strong>Use cases</strong>: Production enterprise deployments, Kubernetes-based architectures.</li>
</ul>
<p><strong>Transport comparison matrix:</strong></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>stdio</th>
<th>HTTP+SSE</th>
<th>Streamable HTTP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Deployment</td>
<td>Local subprocess</td>
<td>Remote service</td>
<td>Remote service</td>
</tr>
<tr>
<td>Latency</td>
<td>~μs</td>
<td>~ms</td>
<td>~ms</td>
</tr>
<tr>
<td>Authentication</td>
<td>Process-level</td>
<td>HTTP headers (OAuth, API keys)</td>
<td>HTTP headers (OAuth, API keys)</td>
</tr>
<tr>
<td>Encryption</td>
<td>N/A (local)</td>
<td>TLS</td>
<td>TLS</td>
</tr>
<tr>
<td>Server push</td>
<td>stdout</td>
<td>SSE stream</td>
<td>SSE / chunked response</td>
</tr>
<tr>
<td>Session management</td>
<td>Implicit (process lifetime)</td>
<td>SSE connection</td>
<td>Explicit session ID</td>
</tr>
<tr>
<td>Multi-tenant</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Scalability</td>
<td>Single host</td>
<td>Multiple clients</td>
<td>Multiple clients + load balancing</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="2433-message-types-in-detail" tabindex="-1">2.4.3.3 Message Types in Detail</h4>
<p>MCP defines a comprehensive set of JSON-RPC methods organized by functional category. Each method has a specific direction (client→server or server→client) and semantics (request or notification).</p>
<p><strong>Initialization Messages</strong></p>
<p>The initialization handshake establishes the session and negotiates capabilities. It MUST be the first exchange on any new connection.</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Direction</th>
<th>Type</th>
<th>Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Client → Server</td>
<td>Request</td>
<td><code>initialize</code></td>
<td>Client proposes protocol version, advertises client capabilities, sends client metadata</td>
</tr>
<tr>
<td>2</td>
<td>Server → Client</td>
<td>Response</td>
<td>(response to <code>initialize</code>)</td>
<td>Server confirms protocol version, advertises server capabilities, sends server metadata</td>
</tr>
<tr>
<td>3</td>
<td>Client → Server</td>
<td>Notification</td>
<td><code>initialized</code></td>
<td>Client confirms initialization is complete; session enters operational state</td>
</tr>
</tbody>
</table>
<p><strong>Detailed <code>initialize</code> request payload:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;initialize&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;protocolVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-06-18&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;capabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;sampling&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;roots&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;listChanged&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;elicitation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;clientInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CustomAgentHost&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3.2.1&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Detailed <code>initialize</code> response payload:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;protocolVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-06-18&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;capabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;tools&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;listChanged&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resources&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;subscribe&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;listChanged&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;prompts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;listChanged&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;logging&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;serverInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;GitHubMCPServer&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.4.0&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Tool Messages</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tools/list</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Enumerate all tools the server exposes</td>
</tr>
<tr>
<td><code>tools/call</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Invoke a specific tool with provided arguments</td>
</tr>
<tr>
<td><code>notifications/tools/list_changed</code></td>
<td>Server → Client</td>
<td>Notification</td>
<td>Signal that the tool set has changed (tools added/removed)</td>
</tr>
</tbody>
</table>
<p><code>tools/list</code> supports pagination via an optional <code>cursor</code> parameter. The response includes a <code>nextCursor</code> field if more tools are available:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// Request</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;tools/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;cursor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;page2token&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;tools&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>...<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;nextCursor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;page3token&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Resource Messages</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resources/list</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Enumerate available resources</td>
</tr>
<tr>
<td><code>resources/read</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Retrieve content of a specific resource by URI</td>
</tr>
<tr>
<td><code>resources/subscribe</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Subscribe to changes on a specific resource</td>
</tr>
<tr>
<td><code>resources/unsubscribe</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Cancel a resource subscription</td>
</tr>
<tr>
<td><code>resources/templates/list</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>List parameterized resource URI templates</td>
</tr>
<tr>
<td><code>notifications/resources/list_changed</code></td>
<td>Server → Client</td>
<td>Notification</td>
<td>Resource set has changed</td>
</tr>
<tr>
<td><code>notifications/resources/updated</code></td>
<td>Server → Client</td>
<td>Notification</td>
<td>A subscribed resource’s content has changed</td>
</tr>
</tbody>
</table>
<p><strong>Prompt Messages</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>prompts/list</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Enumerate available prompt templates</td>
</tr>
<tr>
<td><code>prompts/get</code></td>
<td>Client → Server</td>
<td>Request</td>
<td>Retrieve and expand a prompt template with arguments</td>
</tr>
<tr>
<td><code>notifications/prompts/list_changed</code></td>
<td>Server → Client</td>
<td>Notification</td>
<td>Prompt set has changed</td>
</tr>
</tbody>
</table>
<p><strong>Sampling Messages (Server → Client)</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sampling/createMessage</code></td>
<td>Server → Client</td>
<td>Request</td>
<td>Server requests the host to perform LLM inference</td>
</tr>
</tbody>
</table>
<p>This is a reverse-direction request: the server asks the client to do something (invoke the LLM). The host retains full authority to approve, modify, or reject the request.</p>
<p><strong>Elicitation Messages (Server → Client)</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>elicitation/create</code></td>
<td>Server → Client</td>
<td>Request</td>
<td>Server requests structured user input</td>
</tr>
</tbody>
</table>
<p><strong>Lifecycle Messages</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Direction</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ping</code></td>
<td>Either</td>
<td>Request</td>
<td>Health check; expects <code>pong</code> response (empty <code>result: {}</code>)</td>
</tr>
<tr>
<td><code>notifications/cancelled</code></td>
<td>Either</td>
<td>Notification</td>
<td>Cancel a previously-issued request by <code>id</code></td>
</tr>
<tr>
<td><code>notifications/progress</code></td>
<td>Server → Client</td>
<td>Notification</td>
<td>Report progress on a long-running operation</td>
</tr>
</tbody>
</table>
<p><strong>Progress notification structure:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;notifications/progress&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;progressToken&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;op-12345&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;progress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Processing file 75 of 100...&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>The <code>progressToken</code> is provided by the client in the original request’s <code>_meta.progressToken</code> field. Only requests that include a progress token will receive progress notifications.</p>
<hr>
<h4 id="2434-session-management-and-stateful-connections" tabindex="-1">2.4.3.4 Session Management and Stateful Connections</h4>
<p><strong>Session establishment.</strong> A session begins with the <code>initialize</code> / <code>initialized</code> handshake and persists until either party disconnects. During the session:</p>
<ul>
<li>Both parties maintain the negotiated capability set.</li>
<li>The client tracks outstanding request IDs (requests sent but not yet responded to).</li>
<li>Resource subscriptions remain active.</li>
<li>The server may cache per-session state (e.g., authenticated user identity, workspace context).</li>
</ul>
<p><strong>Session identification.</strong> For HTTP-based transports, the Streamable HTTP specification introduces an explicit <code>Mcp-Session-Id</code> header. For stdio transport, the session is implicitly defined by the process lifetime.</p>
<p><strong>Reconnection semantics.</strong> If the transport connection drops:</p>
<ul>
<li><strong>stdio</strong>: The child process has likely terminated. The host must respawn the server process and re-initialize the session from scratch (full <code>initialize</code> handshake, re-list tools/resources, re-establish subscriptions).</li>
<li><strong>HTTP+SSE</strong>: The SSE connection may drop due to network issues. The client should:
<ol>
<li>Attempt to reconnect to the SSE endpoint.</li>
<li>If the server supports session resumption, include the previous session ID.</li>
<li>If session state is lost, perform a full re-initialization.</li>
</ol>
</li>
<li><strong>Streamable HTTP</strong>: Session affinity via <code>Mcp-Session-Id</code> enables transparent reconnection to load-balanced server instances.</li>
</ul>
<p><strong>Timeout policies:</strong></p>
<ul>
<li><strong>Request timeout</strong>: The client should implement per-request timeouts. If a response is not received within the timeout, the client may:
<ul>
<li>Send a <code>notifications/cancelled</code> notification for the outstanding request.</li>
<li>Mark the request as failed and propagate the error to the host.</li>
</ul>
</li>
<li><strong>Session idle timeout</strong>: The server may disconnect sessions that have been idle beyond a configured threshold. Clients should send periodic <code>ping</code> requests as keep-alives.</li>
<li><strong>Initialization timeout</strong>: If the server does not respond to <code>initialize</code> within a reasonable time (e.g., 30 seconds), the client should abort the connection.</li>
</ul>
<p><strong>Concurrent request handling.</strong> JSON-RPC 2.0 supports concurrent (non-blocking) requests via unique <code>id</code> values. The client may send multiple requests without waiting for responses; the server may respond out of order. Ordering guarantees:</p>
<ul>
<li><strong>No ordering guarantee</strong> between independent requests: The server may process and respond to requests in any order.</li>
<li><strong>Causal ordering</strong> for related operations: If the client needs sequential execution (e.g., read-then-write), it must wait for the first response before sending the second request.</li>
<li><strong>Notification ordering</strong>: Notifications from the server are delivered in the order they are emitted, but interleaving with request responses is possible.</li>
</ul>
<hr>
<h3 id="244-key-primitives-tools-and-others" tabindex="-1">2.4.4 Key Primitives: Tools and Others</h3>
<h4 id="2441-primitives-overview" tabindex="-1">2.4.4.1 Primitives Overview</h4>
<p>MCP defines six core primitives, each with distinct semantics, directionality, and access control characteristics:</p>
<table>
<thead>
<tr>
<th>Primitive</th>
<th>Direction</th>
<th>Initiated By</th>
<th>Controlled By</th>
<th>Primary Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tools</strong></td>
<td>Server exposes → Client invokes</td>
<td>Model (via host)</td>
<td>Model decides when to call</td>
<td>Executable actions: API calls, computations, file operations</td>
</tr>
<tr>
<td><strong>Resources</strong></td>
<td>Server exposes → Client reads</td>
<td>Application (host)</td>
<td>Application decides when to fetch</td>
<td>Contextual data: files, database records, live feeds</td>
</tr>
<tr>
<td><strong>Prompts</strong></td>
<td>Server exposes → Client retrieves</td>
<td>User</td>
<td>User selects which prompt to use</td>
<td>Structured interaction templates: workflows, best practices</td>
</tr>
<tr>
<td><strong>Sampling</strong></td>
<td>Server requests ← Client provides</td>
<td>Server</td>
<td>Host approves/modifies/rejects</td>
<td>LLM inference: server needs model reasoning capability</td>
</tr>
<tr>
<td><strong>Elicitation</strong></td>
<td>Server requests ← Client provides</td>
<td>Server</td>
<td>User provides input</td>
<td>User input: credentials, confirmations, parameter selection</td>
</tr>
<tr>
<td><strong>Roots</strong></td>
<td>Client provides → Server consumes</td>
<td>Client/Host</td>
<td>Host defines boundaries</td>
<td>Operational scope: filesystem paths, workspace boundaries</td>
</tr>
</tbody>
</table>
<p><strong>Control semantics distinction (critical for understanding MCP’s design philosophy):</strong></p>
<ul>
<li>
<p><strong>Model-controlled (Tools)</strong>: The LLM decides whether and when to invoke a tool based on the user’s query and the tool’s description. The host orchestrates the actual call, but the decision-making authority rests with the model.</p>
</li>
<li>
<p><strong>Application-controlled (Resources)</strong>: The host application decides when to fetch resource content and inject it into the model’s context. The model does not directly request resource reads; the application may pre-fetch resources based on conversation context or user actions.</p>
</li>
<li>
<p><strong>User-controlled (Prompts)</strong>: The user explicitly selects a prompt template (e.g., via a slash command <code>/summarize</code> or a UI menu). The model does not autonomously choose prompts.</p>
</li>
</ul>
<p>This three-way control separation enforces a principle: <em>different types of external interactions require different levels of agency and different approval workflows.</em></p>
<hr>
<h4 id="2442-design-philosophy" tabindex="-1">2.4.4.2 Design Philosophy</h4>
<p><strong>Separation of concerns.</strong> Each primitive addresses a distinct interaction pattern:</p>
<ul>
<li><strong>Tools</strong> = <em>doing</em> (executing actions that may change state)</li>
<li><strong>Resources</strong> = <em>knowing</em> (accessing data for contextual awareness)</li>
<li><strong>Prompts</strong> = <em>structuring</em> (organizing interaction patterns into reusable templates)</li>
</ul>
<p>This separation prevents conflation: a tool that reads data is semantically different from a resource that provides data. The tool might have side effects (logging, rate limiting, authentication); the resource is a passive data source.</p>
<p><strong>Principle of least privilege.</strong> Each primitive has the minimum access control necessary for its function:</p>
<ul>
<li>Tools have <code>annotations</code> (destructive, idempotent, read-only hints) that enable graduated approval policies.</li>
<li>Resources are read-only by design; they cannot mutate state.</li>
<li>Prompts are pure templates; they execute no actions.</li>
<li>Sampling requests are explicitly gated by host approval.</li>
<li>Elicitation requests require user consent.</li>
</ul>
<p><strong>Compositional design.</strong> Primitives can be composed for complex workflows:</p>
<ol>
<li>User selects a <strong>prompt</strong> template (e.g., “analyze repository”)</li>
<li>The prompt references <strong>resources</strong> (e.g., <code>repo://main/README.md</code>)</li>
<li>The model, reasoning with the prompt and resources, decides to invoke <strong>tools</strong> (e.g., <code>run_tests</code>, <code>search_code</code>)</li>
<li>A tool server needs further reasoning, so it requests <strong>sampling</strong> from the host</li>
<li>The sampling result requires user confirmation, so the server requests <strong>elicitation</strong></li>
<li>All operations are scoped within <strong>roots</strong> defined by the host</li>
</ol>
<hr>
<h3 id="245-tool-definition-mcp" tabindex="-1">2.4.5 Tool Definition (MCP)</h3>
<h4 id="2451-tool-definition-schema" tabindex="-1">2.4.5.1 Tool Definition Schema</h4>
<p>An MCP tool is defined by a JSON object that provides all information necessary for an LLM to understand the tool’s purpose, determine when to use it, and construct valid invocations.</p>
<p><strong>Complete tool definition schema:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;create_github_issue&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Creates a new issue in a GitHub repository. Use this when the user wants to file a bug report, feature request, or task in a specific repository. Requires the repository owner, repository name, issue title, and optionally a body and labels.&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;inputSchema&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;owner&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The GitHub username or organization that owns the repository&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;repo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The repository name (not the full URL)&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The title of the issue (concise, descriptive)&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;body&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The detailed body of the issue in Markdown format&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;labels&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;array&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;items&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;List of label names to apply to the issue&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;owner&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;repo&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;title&quot;</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;annotations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Create GitHub Issue&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;readOnlyHint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;destructiveHint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;idempotentHint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;openWorldHint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Field semantics:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>Yes</td>
<td>Machine-readable identifier; must be unique within the server; used in <code>tools/call</code></td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>Yes</td>
<td>Natural language description for the LLM; critical for model’s tool selection accuracy</td>
</tr>
<tr>
<td><code>inputSchema</code></td>
<td>JSON Schema object</td>
<td>Yes</td>
<td>Formal specification of accepted input parameters</td>
</tr>
<tr>
<td><code>annotations</code></td>
<td>object</td>
<td>No</td>
<td>Metadata hints for the host’s security and UX policies</td>
</tr>
</tbody>
</table>
<p><strong>Description engineering.</strong> The <code>description</code> field is the primary mechanism by which the LLM determines whether a tool is relevant to the current task. High-quality descriptions should:</p>
<ol>
<li>State the tool’s purpose in the first sentence.</li>
<li>Specify when the tool should be used (positive cases).</li>
<li>Specify when the tool should NOT be used (negative cases), to prevent misuse.</li>
<li>Mention key parameters and their semantics.</li>
<li>Note any prerequisites or side effects.</li>
</ol>
<p>The description is effectively a natural language “API documentation” targeted at an LLM reader, not a human developer.</p>
<hr>
<h4 id="2452-tool-annotations-and-metadata" tabindex="-1">2.4.5.2 Tool Annotations and Metadata</h4>
<p>Annotations provide machine-readable hints about a tool’s behavioral characteristics. They inform the host’s policy engine and UX decisions but are NOT security controls in themselves.</p>
<table>
<thead>
<tr>
<th>Annotation</th>
<th>Type</th>
<th>Default</th>
<th>Semantics</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>title</code></td>
<td>string</td>
<td>—</td>
<td>Human-readable display name for UI rendering</td>
</tr>
<tr>
<td><code>readOnlyHint</code></td>
<td>boolean</td>
<td><code>false</code></td>
<td>If <code>true</code>: tool does not modify any state. Safe for speculative/preview execution.</td>
</tr>
<tr>
<td><code>destructiveHint</code></td>
<td>boolean</td>
<td><code>true</code></td>
<td>If <code>true</code>: tool may cause irreversible changes (delete files, drop tables, send emails). Warrants user confirmation.</td>
</tr>
<tr>
<td><code>idempotentHint</code></td>
<td>boolean</td>
<td><code>false</code></td>
<td>If <code>true</code>: calling the tool multiple times with the same arguments produces the same effect as calling it once. Safe to retry on failure.</td>
</tr>
<tr>
<td><code>openWorldHint</code></td>
<td>boolean</td>
<td><code>true</code></td>
<td>If <code>true</code>: tool interacts with systems outside the server’s control (external APIs, internet). If <code>false</code>: tool operates only on local/contained data.</td>
</tr>
</tbody>
</table>
<p><strong>Policy engine integration.</strong> The host can use annotations to implement graduated approval policies:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>approval_required</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>auto-approve</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">readOnlyHint</mtext><mo>=</mo><mtext>true</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>auto-approve with logging</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">idempotentHint</mtext><mo>=</mo><mtext>true</mtext><mo>∧</mo><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">destructiveHint</mtext><mo>=</mo><mtext>false</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>user confirmation required</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">destructiveHint</mtext><mo>=</mo><mtext>true</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>elevated approval</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">destructiveHint</mtext><mo>=</mo><mtext>true</mtext><mo>∧</mo><mi>t</mi><mi mathvariant="normal">.</mi><mtext mathvariant="monospace">openWorldHint</mtext><mo>=</mo><mtext>true</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{approval\_required}(t) = \begin{cases}
\text{auto-approve} &amp; \text{if } t.\texttt{readOnlyHint} = \text{true} \\
\text{auto-approve with logging} &amp; \text{if } t.\texttt{idempotentHint} = \text{true} \wedge t.\texttt{destructiveHint} = \text{false} \\
\text{user confirmation required} &amp; \text{if } t.\texttt{destructiveHint} = \text{true} \\
\text{elevated approval} &amp; \text{if } t.\texttt{destructiveHint} = \text{true} \wedge t.\texttt{openWorldHint} = \text{true}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">approval_required</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.76em;vertical-align:-2.63em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-1.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.592em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.916em" style="width:0.8889em" viewBox="0 0 888.89 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.916em" style="width:0.8889em" viewBox="0 0 888.89 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"/></svg></span></span><span style="top:-5.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.13em;"><span style="top:-5.13em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">auto-approve</span></span></span></span><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">auto-approve with logging</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">user confirmation required</span></span></span></span><span style="top:-0.81em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">elevated approval</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.63em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.13em;"><span style="top:-5.13em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">readOnlyHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">true</span></span></span></span><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">idempotentHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">true</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">destructiveHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">false</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">destructiveHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">true</span></span></span></span><span style="top:-0.81em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">destructiveHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">true</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord text"><span class="mord texttt">openWorldHint</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">true</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.63em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p><strong>Critical caveat.</strong> Annotations are <em>hints</em> declared by the server developer; they are NOT enforced by the protocol. A malicious or buggy server could declare <code>readOnlyHint: true</code> for a tool that actually deletes data. The host MUST NOT rely solely on annotations for security; they should be treated as advisory input to a defense-in-depth security strategy that includes sandboxing, permission systems, and monitoring.</p>
<hr>
<h4 id="2453-tool-listing-protocol" tabindex="-1">2.4.5.3 Tool Listing Protocol</h4>
<p><strong>Basic listing:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// Request</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;tools/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;tools&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;search_files&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Search for files matching a pattern...&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;inputSchema&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;annotations&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;read_file&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Read the contents of a file...&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;inputSchema&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;annotations&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Pagination.</strong> For servers exposing large numbers of tools, the <code>tools/list</code> method supports cursor-based pagination:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// First page request</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;tools/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// First page response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;tools&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>...first <span class="hljs-number">50</span> tools...<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;nextCursor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;eyJwYWdlIjoxfQ==&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Second page request</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;tools/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;cursor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;eyJwYWdlIjoxfQ==&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Second page response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;tools&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>...next <span class="hljs-number">50</span> tools...<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;nextCursor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span>  <span class="hljs-comment">// no more pages</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Dynamic tool sets.</strong> If the server’s capabilities declare <code>tools.listChanged: true</code>, the server can emit <code>notifications/tools/list_changed</code> notifications when tools are dynamically added, removed, or modified. Upon receiving this notification, the client should re-invoke <code>tools/list</code> to refresh its cached tool definitions.</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// Server → Client notification</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;notifications/tools/list_changed&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>Use cases for dynamic tool sets:</p>
<ul>
<li>A server that discovers available tools at runtime based on installed plugins</li>
<li>A server that exposes different tools based on the authenticated user’s permissions</li>
<li>A server that adds/removes tools based on external configuration changes</li>
</ul>
<p><strong>Caching strategies:</strong></p>
<ul>
<li>Client caches the tool list after <code>tools/list</code> and only refreshes upon <code>notifications/tools/list_changed</code>.</li>
<li>For static tool sets (no <code>listChanged</code> capability), the client can cache indefinitely for the session duration.</li>
<li>Tool descriptions are injected into the LLM’s context; caching avoids redundant context assembly.</li>
</ul>
<hr>
<h4 id="2454-input-schema-design-for-mcp-tools" tabindex="-1">2.4.5.4 Input Schema Design for MCP Tools</h4>
<p>MCP uses <strong>JSON Schema</strong> (draft 2020-12 compatible) as the universal language for describing tool input parameters. This choice provides:</p>
<ul>
<li><strong>Formal validation</strong>: Inputs can be validated against the schema before tool invocation.</li>
<li><strong>Rich type system</strong>: Supports primitive types, arrays, objects, enums, patterns, constraints.</li>
<li><strong>LLM compatibility</strong>: JSON Schema is the same format used by OpenAI, Anthropic, and other providers for function calling.</li>
<li><strong>Self-documentation</strong>: <code>description</code> fields in the schema serve as parameter-level documentation for the LLM.</li>
</ul>
<p><strong>Complex nested structure example:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;filters&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;array&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;items&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The field to filter on&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
              <span class="hljs-attr">&quot;operator&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">&quot;enum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;eq&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;neq&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;gt&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;lt&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;gte&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;lte&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;contains&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The comparison operator&quot;</span>
              <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
              <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The value to compare against&quot;</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">&quot;oneOf&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                  <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;number&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;boolean&quot;</span> <span class="hljs-punctuation">}</span>
                <span class="hljs-punctuation">]</span>
              <span class="hljs-punctuation">}</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;field&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;operator&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;value&quot;</span><span class="hljs-punctuation">]</span>
          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Array of filter conditions (combined with AND logic)&quot;</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;sort_by&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Field to sort results by&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;sort_order&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;enum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;asc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;desc&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;asc&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;minimum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;maximum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span> <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;filters&quot;</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;query&quot;</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Cross-field validation and conditional schemas:</strong></p>
<p>JSON Schema supports <code>if/then/else</code> for expressing parameter dependencies:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;enum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;create&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;update&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;delete&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;action&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;if&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;const&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;create&quot;</span> <span class="hljs-punctuation">}</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;then&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;data&quot;</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;else&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;id&quot;</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>This schema expresses: “if <code>action</code> is <code>create</code>, then <code>data</code> is required; otherwise, <code>id</code> is required.”</p>
<p><strong>Schema evolution and backward compatibility:</strong></p>
<p>When a tool’s input schema changes (e.g., adding new optional parameters, changing constraints), the server should:</p>
<ol>
<li><strong>Additive changes</strong> (adding optional fields): backward compatible. Existing clients that omit the new field continue to work.</li>
<li><strong>Constraint tightening</strong> (adding <code>required</code> fields, narrowing <code>enum</code> values): breaking change. Must be communicated via <code>notifications/tools/list_changed</code> so clients refresh their cached schemas.</li>
<li><strong>Type changes</strong> (changing a field from <code>string</code> to <code>integer</code>): breaking change. Requires careful version management.</li>
</ol>
<hr>
<h3 id="246-tool-results" tabindex="-1">2.4.6 Tool Results</h3>
<h4 id="2461-result-structure" tabindex="-1">2.4.6.1 Result Structure</h4>
<p>Every <code>tools/call</code> response follows a standardized result structure:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Successfully created issue #42: &#x27;Fix login bug&#x27; in user/repo&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;isError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Fields:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Semantics</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>content</code></td>
<td>array of content objects</td>
<td>Yes</td>
<td>The tool’s output, potentially multi-part and multi-modal</td>
</tr>
<tr>
<td><code>isError</code></td>
<td>boolean</td>
<td>No (default <code>false</code>)</td>
<td>Whether the result represents an error condition</td>
</tr>
</tbody>
</table>
<p>The <code>content</code> array allows tools to return rich, multi-part responses. For example, a data analysis tool might return both a textual summary and a chart image.</p>
<hr>
<h4 id="2462-content-types-in-results" tabindex="-1">2.4.6.2 Content Types in Results</h4>
<p>MCP defines several content types that can appear in the <code>content</code> array:</p>
<p><strong>Text content:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The query returned 42 results. Top result: ...&quot;</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>The most common content type. Text is interpreted by the LLM as natural language (or structured text like JSON, Markdown, CSV, etc.). The text should be informative and structured for LLM consumption.</p>
<p><strong>Image content:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;image&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;iVBORw0KGgoAAAANSUhEUg...&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;image/png&quot;</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>Binary image data, Base64-encoded for JSON transport. Supported MIME types include <code>image/png</code>, <code>image/jpeg</code>, <code>image/gif</code>, <code>image/webp</code>. The host injects the image into the model’s context (for multimodal models) or displays it to the user.</p>
<p><strong>Audio content:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;audio&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;UklGRi4AAABXQVZFZm10...&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;audio/wav&quot;</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>Binary audio data, Base64-encoded. Useful for speech synthesis, audio analysis, and music generation tools.</p>
<p><strong>Embedded resource content:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;resource&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;resource&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file:///project/src/main.py&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text/x-python&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;import os\n\ndef main():\n    ...&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>A resource reference embedded in a tool result. This allows tools to return data that is semantically a “resource” (with a URI for identification) rather than raw text. The host can cache, display, or re-use the resource in subsequent interactions.</p>
<p><strong>Multi-part results:</strong></p>
<p>A single tool call can return multiple content items:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Analysis complete. Found 3 anomalies in the dataset.&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;image&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;iVBORw0KGgoAAAA...&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;image/png&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;| Anomaly | Timestamp | Severity |\n|---------|-----------|----------|\n| #1 | 2024-03-15 | High | ...&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;isError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><hr>
<h4 id="2463-result-semantics" tabindex="-1">2.4.6.3 Result Semantics</h4>
<p><strong>Model-directed results.</strong> Tool results in MCP are fundamentally directed at the model, not the user. The result content is injected back into the LLM’s context window as part of the ongoing conversation, enabling the model to:</p>
<ol>
<li><strong>Reason</strong> over the result (e.g., analyze returned data, identify patterns).</li>
<li><strong>Plan</strong> next actions based on the result (e.g., call another tool, ask clarifying questions).</li>
<li><strong>Synthesize</strong> the result into a user-facing response (e.g., summarize API output in natural language).</li>
</ol>
<p>This design principle means that tool results should be <strong>machine-readable first, human-readable second</strong>. For example:</p>
<ul>
<li>Return structured data (JSON, CSV, Markdown tables) rather than prose paragraphs.</li>
<li>Include all relevant details; the model will select what to surface to the user.</li>
<li>Use consistent formatting so the model can reliably parse the output.</li>
</ul>
<p><strong>Context window budget.</strong> Tool results consume tokens in the model’s context window. The total context budget must accommodate:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>T</mi><mtext>total</mtext></msub><mo>=</mo><msub><mi>T</mi><mtext>system</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext>history</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext>tool_defs</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext>tool_results</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext>generation</mtext></msub></mrow><annotation encoding="application/x-tex">
T_{\text{total}} = T_{\text{system}} + T_{\text{history}} + T_{\text{tool\_defs}} + T_{\text{tool\_results}} + T_{\text{generation}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">system</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">history</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tool_defs</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tool_results</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">generation</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>tool_results</mtext></msub></mrow><annotation encoding="application/x-tex">T_{\text{tool\_results}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tool_results</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span></span></span></span></eq> is the cumulative token count of all tool results in the current turn. Large tool results (e.g., full file contents, extensive API responses) should be truncated, summarized, or paginated to stay within budget.</p>
<hr>
<h3 id="247-structured-content" tabindex="-1">2.4.7 Structured Content</h3>
<h4 id="2471-multi-modal-content-representation" tabindex="-1">2.4.7.1 Multi-Modal Content Representation</h4>
<p>MCP’s content model is designed for multi-modal AI systems that can process text, images, audio, and structured data within a unified interaction.</p>
<p><strong>Unified content array.</strong> All content, regardless of modality, is represented as elements of a single <code>content</code> array. This design:</p>
<ul>
<li>Enables interleaving of modalities (text explanation followed by image, followed by more text)</li>
<li>Provides a consistent interface for hosts to iterate over and render content items</li>
<li>Supports progressive adoption: hosts that don’t support images can filter to <code>type: &quot;text&quot;</code> items</li>
</ul>
<p><strong>MIME type specification.</strong> Non-text content items include a <code>mimeType</code> field that enables:</p>
<ul>
<li>Proper rendering by the host UI</li>
<li>Correct encoding/decoding</li>
<li>Model compatibility checking (e.g., some models support only certain image formats)</li>
</ul>
<p><strong>Base64 encoding for binary data.</strong> Since the transport is JSON-based, binary data (images, audio) must be encoded as text. MCP uses Base64 encoding:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>size</mtext><mtext>base64</mtext></msub><mo>=</mo><mrow><mo fence="true">⌈</mo><mfrac><mn>4</mn><mn>3</mn></mfrac><mo>⋅</mo><msub><mtext>size</mtext><mtext>binary</mtext></msub><mo fence="true">⌉</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{size}_{\text{base64}} = \left\lceil \frac{4}{3} \cdot \text{size}_{\text{binary}} \right\rceil
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8179em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">base64</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌈</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">binary</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌉</span></span></span></span></span></span></span></eqn></section><p>This imposes approximately 33% overhead on binary content. For large binary payloads, this overhead can be significant; in practice, MCP tool results should keep binary content reasonably sized (&lt; 10 MB as a guideline) or use resource URIs for large files.</p>
<p><strong>Size limits and chunking.</strong> The MCP specification does not prescribe hard size limits for individual content items or total result payloads. However, practical limits arise from:</p>
<ul>
<li>JSON parser memory limits</li>
<li>Transport-layer payload limits (HTTP request body size)</li>
<li>Model context window capacity</li>
<li>Network bandwidth and latency</li>
</ul>
<p>For large content, servers should implement pagination, truncation, or return resource URIs that the client can fetch on demand.</p>
<hr>
<h4 id="2472-content-annotations" tabindex="-1">2.4.7.2 Content Annotations</h4>
<p>Content items can include annotations that provide rendering and prioritization hints:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Internal analysis: confidence score 0.73, p-value 0.002&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;annotations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;priority&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;audience&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Priority hints:</strong></p>
<p>The <code>priority</code> field is a floating-point value in <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0.0</mn><mo separator="true">,</mo><mn>1.0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0.0, 1.0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1.0</span><span class="mclose">]</span></span></span></span></eq> indicating the relative importance of the content item:</p>
<ul>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>priority</mtext><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\text{priority} = 1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">priority</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.0</span></span></span></span></eq>: Highest priority; should always be included in the model context.</li>
<li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>priority</mtext><mo>=</mo><mn>0.0</mn></mrow><annotation encoding="application/x-tex">\text{priority} = 0.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">priority</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.0</span></span></span></span></eq>: Lowest priority; can be omitted if context space is limited.</li>
</ul>
<p>The host can use priority hints to implement intelligent context window management:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>include</mtext><mo stretchy="false">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>true</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><msub><mo>∑</mo><mrow><mi>j</mi><mo>:</mo><msub><mi>p</mi><mi>j</mi></msub><mo>≥</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></msub><msub><mi>T</mi><mi>j</mi></msub><mo>≤</mo><msub><mi>T</mi><mtext>budget</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>false</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{include}(c_i) = \begin{cases}
\text{true} &amp; \text{if } \sum_{j : p_j \geq p_i} T_j \leq T_{\text{budget}} \\
\text{false} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">include</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7225em;"><span style="top:-3.7225em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">true</span></span></span></span><span style="top:-2.2175em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">false</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2225em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7225em;"><span style="top:-3.7225em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">:</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">≥</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">budget</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.2175em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2225em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p>where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>is the priority of content item<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">T_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>is its token count, and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>budget</mtext></msub></mrow><annotation encoding="application/x-tex">T_{\text{budget}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">budget</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq> is the remaining context budget.</p>
<p><strong>Audience hints:</strong></p>
<p>The <code>audience</code> field specifies the intended recipients:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[&quot;user&quot;]</code></td>
<td>Content intended for the user’s display; should be shown in the UI but may not need to be in the model’s context</td>
</tr>
<tr>
<td><code>[&quot;assistant&quot;]</code></td>
<td>Content intended for the model’s reasoning; should be in the model’s context but may not need to be shown to the user</td>
</tr>
<tr>
<td><code>[&quot;user&quot;, &quot;assistant&quot;]</code></td>
<td>Content for both; shown to user AND included in model context</td>
</tr>
</tbody>
</table>
<p>This enables selective information routing:</p>
<ul>
<li>Debug information (<code>audience: [&quot;assistant&quot;]</code>): injected into model context for reasoning but not cluttering the user’s view.</li>
<li>Visual results (<code>audience: [&quot;user&quot;]</code>): displayed to the user as rich content but not consuming model context tokens.</li>
<li>Primary results (<code>audience: [&quot;user&quot;, &quot;assistant&quot;]</code>): both displayed and reasoned over.</li>
</ul>
<hr>
<h3 id="248-error-handling" tabindex="-1">2.4.8 Error Handling</h3>
<h4 id="2481-error-levels-in-mcp" tabindex="-1">2.4.8.1 Error Levels in MCP</h4>
<p>MCP has a three-tier error model, each addressing failures at different abstraction levels:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs">┌────────────────────────────────────────────┐
│  Tier 3: Tool Execution Errors              │
│  (isError: true in tool result)             │
├────────────────────────────────────────────┤
│  Tier 2: Protocol-Level Errors              │
│  (JSON-RPC error response)                  │
├────────────────────────────────────────────┤
│  Tier 1: Transport-Level Errors             │
│  (connection failures, timeouts, TLS)       │
└────────────────────────────────────────────┘
</code></pre>
</div><p><strong>Tier 1: Transport-Level Errors</strong></p>
<p>These occur below the JSON-RPC layer and prevent message delivery entirely:</p>
<table>
<thead>
<tr>
<th>Error</th>
<th>Cause</th>
<th>Recovery</th>
</tr>
</thead>
<tbody>
<tr>
<td>Connection refused</td>
<td>Server not running, wrong port</td>
<td>Retry with backoff; check server status</td>
</tr>
<tr>
<td>Connection reset</td>
<td>Server crashed, network partition</td>
<td>Reconnect; re-initialize session</td>
</tr>
<tr>
<td>TLS handshake failure</td>
<td>Certificate mismatch, expired cert</td>
<td>Fix certificate configuration</td>
</tr>
<tr>
<td>DNS resolution failure</td>
<td>Server hostname unresolvable</td>
<td>Check network configuration</td>
</tr>
<tr>
<td>Timeout</td>
<td>Server unresponsive, network congestion</td>
<td>Retry with increased timeout; circuit breaker</td>
</tr>
</tbody>
</table>
<p><strong>Tier 2: Protocol-Level Errors (JSON-RPC)</strong></p>
<p>These are valid JSON-RPC error responses indicating that the request could not be processed at the protocol level:</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Name</th>
<th>Typical Cause</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32700</mn></mrow><annotation encoding="application/x-tex">-32700</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32700</span></span></span></span></eq></td>
<td>Parse error</td>
<td>Malformed JSON in request body</td>
<td>Missing closing brace, invalid unicode escape</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32600</mn></mrow><annotation encoding="application/x-tex">-32600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32600</span></span></span></span></eq></td>
<td>Invalid request</td>
<td>Valid JSON but not conforming to JSON-RPC 2.0</td>
<td>Missing <code>jsonrpc</code> field, wrong version string</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32601</mn></mrow><annotation encoding="application/x-tex">-32601</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32601</span></span></span></span></eq></td>
<td>Method not found</td>
<td>Requested method not supported by server</td>
<td>Calling <code>resources/read</code> on a server that doesn’t expose resources</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32602</mn></mrow><annotation encoding="application/x-tex">-32602</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32602</span></span></span></span></eq></td>
<td>Invalid params</td>
<td>Parameters don’t match expected schema</td>
<td>Wrong argument types, missing required parameters</td>
</tr>
<tr>
<td><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>32603</mn></mrow><annotation encoding="application/x-tex">-32603</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">32603</span></span></span></span></eq></td>
<td>Internal error</td>
<td>Unspecified server-side failure during processing</td>
<td>Unhandled exception in server code</td>
</tr>
</tbody>
</table>
<p>Protocol-level errors are reported via JSON-RPC error responses and typically indicate a bug in the client, the server, or a mismatch in expectations. They are NOT passed to the model; the host handles them internally (retry, error display, fallback).</p>
<p><strong>Tier 3: Tool Execution Errors</strong></p>
<p>These represent failures during the actual tool execution (the tool ran, but the operation it attempted failed):</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Error: Repository &#x27;user/nonexistent-repo&#x27; not found. The repository may not exist or you may not have access permissions. HTTP 404 from GitHub API.&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;isError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>Tool execution errors are semantically part of the tool’s result. They are returned to the model as context, enabling the model to reason about the failure and take corrective action.</p>
<hr>
<h4 id="2482-error-reporting-for-tool-execution" tabindex="-1">2.4.8.2 Error Reporting for Tool Execution</h4>
<p><strong>Design principle.</strong> Tool execution errors are fundamentally different from protocol errors. A <code>tools/call</code> that results in a tool execution error is a <em>successful</em> JSON-RPC request—the request was properly received, parsed, routed, and executed. The tool simply produced an error result. Therefore:</p>
<ul>
<li>The JSON-RPC response has <code>result</code> (not <code>error</code>).</li>
<li>The result contains <code>isError: true</code> and a descriptive error message in <code>content</code>.</li>
<li>The error message is injected into the model’s context for reasoning.</li>
</ul>
<p><strong>Model-driven error recovery.</strong> The model, upon receiving an error result, can:</p>
<ol>
<li><strong>Retry with corrected arguments</strong>: “The file path was wrong; let me try with the correct path.”</li>
<li><strong>Try an alternative tool</strong>: “File search failed; let me try the database query tool instead.”</li>
<li><strong>Ask the user for clarification</strong>: “I couldn’t find that repository. Could you check the name?”</li>
<li><strong>Report the failure</strong>: “I was unable to create the issue because the repository doesn’t exist.”</li>
</ol>
<p>This design enables autonomous error recovery in agentic loops without requiring hard-coded retry logic in the host.</p>
<p><strong>Error message quality guidelines:</strong></p>
<ul>
<li><strong>Be specific</strong>: “Repository ‘user/repo’ not found (HTTP 404)” not “An error occurred.”</li>
<li><strong>Include actionable information</strong>: Suggest what went wrong and how to fix it.</li>
<li><strong>Don’t leak sensitive data</strong>: Don’t include internal stack traces, database connection strings, or authentication tokens.</li>
<li><strong>Use structured format</strong>: If the error has multiple aspects, use a structured format the model can parse.</li>
</ul>
<hr>
<h4 id="2483-retry-and-recovery-strategies" tabindex="-1">2.4.8.3 Retry and Recovery Strategies</h4>
<p><strong>Idempotent tools</strong> (<code>idempotentHint: true</code>):</p>
<ul>
<li>Safe to retry automatically on transient failures (network timeouts, server overload).</li>
<li>The host can implement automatic retry with exponential backoff:</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mtext>wait</mtext></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>t</mi><mtext>base</mtext></msub><mo>⋅</mo><msup><mn>2</mn><mi>n</mi></msup><mo>+</mo><mtext>jitter</mtext><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>t</mi><mtext>max</mtext></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
t_{\text{wait}}(n) = \min\left(t_{\text{base}} \cdot 2^n + \text{jitter}(n), t_{\text{max}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">wait</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">base</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">jitter</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></eqn></section><p>where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>is the retry attempt number,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mtext>base</mtext></msub></mrow><annotation encoding="application/x-tex">t_{\text{base}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">base</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>is the base delay, and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mtext>max</mtext></msub></mrow><annotation encoding="application/x-tex">t_{\text{max}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> is the maximum delay cap.</p>
<p><strong>Non-idempotent tools</strong> (<code>idempotentHint: false</code>):</p>
<ul>
<li>Retrying may cause duplicate side effects (e.g., creating two identical issues, sending two emails).</li>
<li>The host should NOT automatically retry. Instead:
<ul>
<li>Surface the error to the model for decision-making.</li>
<li>Or surface the error to the user for manual retry approval.</li>
</ul>
</li>
</ul>
<p><strong>Circuit breaker pattern.</strong> For tools that fail repeatedly, the host should implement circuit breaker logic:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>state</mtext><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>CLOSED</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>normal operation; requests pass through</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>OPEN</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>after </mtext><mi>k</mi><mtext> consecutive failures; requests immediately rejected for </mtext><msub><mi>t</mi><mtext>cool</mtext></msub><mtext> seconds</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>HALF-OPEN</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>after cooldown; one test request allowed to check recovery</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{state} = \begin{cases}
\text{CLOSED} &amp; \text{normal operation; requests pass through} \\
\text{OPEN} &amp; \text{after } k \text{ consecutive failures; requests immediately rejected for } t_{\text{cool}} \text{ seconds} \\
\text{HALF-OPEN} &amp; \text{after cooldown; one test request allowed to check recovery}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">state</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">CLOSED</span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">OPEN</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">HALF-OPEN</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">normal operation; requests pass through</span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">after </span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord text"><span class="mord"> consecutive failures; requests immediately rejected for </span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cool</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord"> seconds</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">after cooldown; one test request allowed to check recovery</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p>This prevents cascading failures and reduces load on failing servers.</p>
<p><strong>Graceful degradation.</strong> When a tool is unavailable:</p>
<ul>
<li>The host can remove it from the tool list provided to the model.</li>
<li>The host can replace it with a stub that returns a helpful error message.</li>
<li>The host can suggest alternative tools that provide similar functionality.</li>
</ul>
<hr>
<h3 id="249-other-capabilities" tabindex="-1">2.4.9 Other Capabilities</h3>
<h4 id="2491-resources" tabindex="-1">2.4.9.1 Resources</h4>
<p><strong>Definition.</strong> Resources are server-controlled data sources that provide contextual information to the AI model. Unlike tools (which perform actions), resources are passive data providers.</p>
<p><strong>URI-based addressing.</strong> Every resource is identified by a URI:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs">file:///home/user/project/README.md
https://api.example.com/data/reports/q4-2024
postgres://db.internal/sales/customers
custom://myserver/live-metrics
</code></pre>
</div><p>The URI scheme indicates the resource type; the server is responsible for resolving URIs to content.</p>
<p><strong>Resource listing and reading:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// List resources</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;resources/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;resources&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/README.md&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Project README&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Main project documentation&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text/markdown&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/config.yaml&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Configuration&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Application configuration file&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;application/yaml&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Read a specific resource</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;resources/read&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/README.md&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;contents&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/README.md&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text/markdown&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;# My Project\n\nThis is a project that...&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Subscription model.</strong> For resources that change over time (live data feeds, files being edited), MCP supports subscriptions:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// Subscribe to changes</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;resources/subscribe&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/config.yaml&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Server sends notification when resource changes</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;notifications/resources/updated&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/config.yaml&quot;</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Client re-reads the resource to get updated content</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;resources/read&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file:///project/config.yaml&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Resource templates.</strong> For dynamic resources parameterized by variables:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;uriTemplate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;github://repos/{owner}/{repo}/issues/{issue_number}&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;GitHub Issue&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;A specific GitHub issue&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;mimeType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;application/json&quot;</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>The client can construct concrete URIs by substituting template variables.</p>
<p><strong>Resources vs. Tools — the critical distinction:</strong></p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Resources</th>
<th>Tools</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Control</strong></td>
<td>Application-controlled: the host/application decides when to fetch</td>
<td>Model-controlled: the model decides when to invoke</td>
</tr>
<tr>
<td><strong>Side effects</strong></td>
<td>None (read-only by definition)</td>
<td>May have side effects (create, update, delete)</td>
</tr>
<tr>
<td><strong>Context injection</strong></td>
<td>Pre-fetched and injected into context before model reasoning</td>
<td>Invoked during model reasoning as needed</td>
</tr>
<tr>
<td><strong>Use case</strong></td>
<td>Providing background context, reference data</td>
<td>Executing actions, querying dynamic data</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="2492-prompts" tabindex="-1">2.4.9.2 Prompts</h4>
<p><strong>Definition.</strong> Prompts are server-provided templates that structure LLM interactions into reusable, parameterized patterns. They encode best practices, domain-specific workflows, and standardized interaction formats.</p>
<p><strong>Prompt listing and retrieval:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-comment">// List prompts</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;prompts/list&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;prompts&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;code_review&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Generate a thorough code review for a given file&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;arguments&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;file_path&quot;</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Path to the file to review&quot;</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span>
          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;review_focus&quot;</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Specific aspect to focus on (security, performance, readability)&quot;</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">false</span></span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Get expanded prompt</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;prompts/get&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;code_review&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;arguments&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;file_path&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/src/auth.py&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;review_focus&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;security&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response: expanded prompt messages</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Code review for /src/auth.py focusing on security&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;messages&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;You are an expert code reviewer specializing in security analysis...&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Please review the following file for security vulnerabilities:\n\n```python\nimport os\n...\n```&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>User-controlled selection.</strong> Prompts are typically surfaced to the user via slash commands (e.g., <code>/code_review</code>) or UI menus. The user explicitly selects a prompt; the model does not autonomously choose prompts. This ensures that prompt selection remains a human decision aligned with user intent.</p>
<p><strong>Multi-turn prompt sequences.</strong> A single prompt can expand into multiple messages with different roles (system, user, assistant), enabling complex interaction setups:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-attr">&quot;messages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;System instructions...&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Initial user context...&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Primed assistant response...&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Follow-up with specific task...&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
</div><hr>
<h4 id="2493-sampling" tabindex="-1">2.4.9.3 Sampling</h4>
<p><strong>Definition.</strong> Sampling is the mechanism by which an MCP server requests the host to perform LLM inference on the server’s behalf. This is a <em>reverse-direction</em> operation: the server is asking the client to do something, rather than the client asking the server.</p>
<p><strong>Why does a server need LLM inference?</strong></p>
<ol>
<li><strong>Agentic sub-loops</strong>: The server is implementing a multi-step workflow that requires intermediate reasoning (e.g., analyzing search results to refine a query).</li>
<li><strong>Content generation</strong>: The server needs to generate text (summaries, translations, code) as part of its tool execution.</li>
<li><strong>Decision making</strong>: The server needs the model to choose between options based on complex criteria.</li>
<li><strong>Recursive processing</strong>: A tool result needs further analysis before final output.</li>
</ol>
<p><strong>Sampling request structure:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;server-req-1&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;sampling/createMessage&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;messages&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Analyze the following error log and identify the root cause:\n\n[ERROR] 2024-03-15 Connection timeout to db-primary...&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;modelPreferences&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;hints&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;claude-sonnet-4-20250514&quot;</span><span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;intelligencePriority&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;speedPriority&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;costPriority&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.3</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;systemPrompt&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;You are a systems reliability engineer...&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;maxTokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;temperature&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;includeContext&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;thisServer&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Host control.</strong> The host retains absolute authority over sampling requests:</p>
<ul>
<li><strong>Approve or reject</strong>: The host may refuse the sampling request entirely (e.g., rate limit exceeded, policy violation).</li>
<li><strong>Modify the request</strong>: The host may alter the messages, system prompt, model selection, or parameters before executing.</li>
<li><strong>Choose the model</strong>: The <code>modelPreferences</code> are hints; the host decides which model to actually use.</li>
<li><strong>Filter the response</strong>: The host may redact or modify the model’s response before returning it to the server.</li>
<li><strong>Human-in-the-loop</strong>: The host may present the sampling request to the user for approval before execution.</li>
</ul>
<p><strong>Privacy consideration.</strong> The server should not receive raw model responses that contain information from other servers’ contexts or private user data. The <code>includeContext</code> parameter controls what context is shared:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;none&quot;</code></td>
<td>Only the messages in the sampling request are used; no additional context</td>
</tr>
<tr>
<td><code>&quot;thisServer&quot;</code></td>
<td>Include context from this server’s tools/resources but not from other servers</td>
</tr>
<tr>
<td><code>&quot;allServers&quot;</code></td>
<td>Include context from all connected servers (broader context, higher privacy risk)</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="2494-elicitation" tabindex="-1">2.4.9.4 Elicitation</h4>
<p><strong>Definition.</strong> Elicitation allows an MCP server to request structured input directly from the user, mediated by the client/host. Unlike sampling (which requests LLM inference), elicitation requests <em>human</em> input.</p>
<p><strong>Use cases:</strong></p>
<ul>
<li>Requesting authentication credentials (username, password, API key)</li>
<li>Asking for confirmation before a destructive operation</li>
<li>Collecting parameter values that the model cannot determine</li>
<li>Disambiguating between multiple interpretation options</li>
</ul>
<p><strong>Elicitation request structure:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;server-req-2&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;elicitation/create&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Please provide your GitHub personal access token to proceed with repository access.&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;requestedSchema&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;GitHub personal access token&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;minLength&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">40</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;token&quot;</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p><strong>Host rendering.</strong> The host/client receives the elicitation request and renders an appropriate UI widget:</p>
<ul>
<li>Text input field for string values</li>
<li>Dropdown/select for enum values</li>
<li>Checkbox for boolean values</li>
<li>Secure/masked input for password/token fields</li>
<li>Multi-field form for complex schemas</li>
</ul>
<p><strong>Elicitation response:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;server-req-2&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;accept&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><table>
<thead>
<tr>
<th>Action</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;accept&quot;</code></td>
<td>User provided the requested input</td>
</tr>
<tr>
<td><code>&quot;decline&quot;</code></td>
<td>User explicitly refused to provide input</td>
</tr>
<tr>
<td><code>&quot;dismiss&quot;</code></td>
<td>User dismissed the dialog without responding</td>
</tr>
</tbody>
</table>
<p><strong>Security.</strong> The host may:</p>
<ul>
<li>Refuse to render the elicitation request (e.g., disallow credential collection from untrusted servers).</li>
<li>Validate the collected input against the schema before returning it to the server.</li>
<li>Mask sensitive input in logs and audit trails.</li>
<li>Rate-limit elicitation requests to prevent UI spam.</li>
</ul>
<hr>
<h4 id="2495-roots" tabindex="-1">2.4.9.5 Roots</h4>
<p><strong>Definition.</strong> Roots are URIs provided by the client to the server that define the operational boundaries—the “workspace” within which the server should operate.</p>
<p><strong>Example:</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;roots&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file:///home/user/projects/my-app&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;My Application&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file:///home/user/shared-libs&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Shared Libraries&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>This tells the server: “You should only operate on files within <code>my-app/</code> and <code>shared-libs/</code>. Do not access files outside these directories.”</p>
<p><strong>Informational, not enforced.</strong> Roots are guidance signals, not hard security boundaries. A well-behaved server respects roots; a malicious server might ignore them. The host must enforce actual filesystem permissions via OS-level sandboxing, container isolation, or permission systems.</p>
<p><strong>Dynamic updates.</strong> If the client declares <code>roots.listChanged: true</code> during capability negotiation, it can send <code>notifications/roots/list_changed</code> when the workspace changes (e.g., user opens a new project folder). The server should re-query roots and adjust its behavior accordingly.</p>
<hr>
<h2 id="25-model-context-protocol-for-and-against" tabindex="-1">2.5 Model Context Protocol: For and Against</h2>
<h3 id="251-capabilities-and-strategic-advantages" tabindex="-1">2.5.1 Capabilities and Strategic Advantages</h3>
<h4 id="2511-accelerating-development-and-fostering-a-reusable-ecosystem" tabindex="-1">2.5.1.1 Accelerating Development and Fostering a Reusable Ecosystem</h4>
<p><strong>Integration effort reduction.</strong> As formally derived in §2.4.1.3, MCP reduces integration complexity from <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>×</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N \times M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></eq>to<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N + M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></eq>. For a concrete analysis, consider the expected engineering effort:</p>
<p>Let <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq> be the average cost (person-days) of building and maintaining one custom integration. The total ecosystem cost without MCP:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Cost</mtext><mtext>without</mtext></msub><mo>=</mo><mi>c</mi><mo>⋅</mo><mi>N</mi><mo>⋅</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">
\text{Cost}_{\text{without}} = c \cdot N \cdot M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Cost</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">without</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eqn></section><p>With MCP, each application builds one client (cost <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext>client</mtext></msub></mrow><annotation encoding="application/x-tex">c_{\text{client}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">client</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>) and each tool builds one server (cost <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext>server</mtext></msub></mrow><annotation encoding="application/x-tex">c_{\text{server}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">server</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>). Additionally, both can leverage shared SDK libraries (cost <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext>SDK</mtext></msub></mrow><annotation encoding="application/x-tex">c_{\text{SDK}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">SDK</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>, amortized):</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Cost</mtext><mtext>with</mtext></msub><mo>=</mo><mi>N</mi><mo>⋅</mo><msub><mi>c</mi><mtext>client</mtext></msub><mo>+</mo><mi>M</mi><mo>⋅</mo><msub><mi>c</mi><mtext>server</mtext></msub><mo>+</mo><msub><mi>c</mi><mtext>SDK</mtext></msub></mrow><annotation encoding="application/x-tex">
\text{Cost}_{\text{with}} = N \cdot c_{\text{client}} + M \cdot c_{\text{server}} + c_{\text{SDK}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Cost</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">with</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">client</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">server</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">SDK</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>The break-even condition occurs when <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Cost</mtext><mtext>with</mtext></msub><mo>&lt;</mo><msub><mtext>Cost</mtext><mtext>without</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Cost}_{\text{with}} &lt; \text{Cost}_{\text{without}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Cost</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">with</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Cost</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">without</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo>⋅</mo><msub><mi>c</mi><mtext>client</mtext></msub><mo>+</mo><mi>M</mi><mo>⋅</mo><msub><mi>c</mi><mtext>server</mtext></msub><mo>+</mo><msub><mi>c</mi><mtext>SDK</mtext></msub><mo>&lt;</mo><mi>c</mi><mo>⋅</mo><mi>N</mi><mo>⋅</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">
N \cdot c_{\text{client}} + M \cdot c_{\text{server}} + c_{\text{SDK}} &lt; c \cdot N \cdot M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">client</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">server</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">SDK</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eqn></section><p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo separator="true">,</mo><mi>M</mi><mo>≫</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N, M \gg 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></eq>, this is almost always satisfied because the left side grows linearly while the right side grows quadratically.</p>
<p><strong>Ecosystem effects.</strong> MCP enables a “write-once, use-everywhere” tool ecosystem:</p>
<ul>
<li>A GitHub MCP server written by one developer is immediately usable by every MCP-compliant host (Claude Desktop, custom agents, IDE extensions).</li>
<li>Community-maintained registries of MCP servers emerge (analogous to npm for Node.js packages or pip for Python packages).</li>
<li>Tool quality improves through community feedback and contributions, as opposed to siloed internal integrations.</li>
</ul>
<p><strong>Open-source MCP server ecosystem (current state):</strong></p>
<table>
<thead>
<tr>
<th>Domain</th>
<th>Example MCP Servers</th>
<th>Functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version control</td>
<td>GitHub, GitLab</td>
<td>Issue management, PR review, code search</td>
</tr>
<tr>
<td>Communication</td>
<td>Slack, Discord</td>
<td>Message sending, channel management</td>
</tr>
<tr>
<td>Databases</td>
<td>PostgreSQL, SQLite</td>
<td>Query execution, schema inspection</td>
</tr>
<tr>
<td>Filesystems</td>
<td>Local filesystem</td>
<td>File read/write, directory navigation</td>
</tr>
<tr>
<td>Search</td>
<td>Brave Search, Google</td>
<td>Web search, result retrieval</td>
</tr>
<tr>
<td>Cloud</td>
<td>AWS, GCP</td>
<td>Resource management, deployment</td>
</tr>
<tr>
<td>Development</td>
<td>Docker, Kubernetes</td>
<td>Container management, deployment</td>
</tr>
</tbody>
</table>
<p><strong>Rapid prototyping.</strong> The standardized interface reduces time-to-first-tool from days (building a custom integration) to minutes (implementing an MCP server with the SDK).</p>
<p><strong>Cross-platform compatibility.</strong> An MCP tool server developed for use with Claude Desktop automatically works with any other MCP-compliant host, including:</p>
<ul>
<li>Custom agentic applications</li>
<li>IDE extensions</li>
<li>Enterprise AI platforms</li>
<li>Research prototypes</li>
</ul>
<p><strong>Lower barrier to entry.</strong> Tool developers only need to understand the MCP specification; they do not need expertise in each AI platform’s specific function-calling format, SDK, or authentication system.</p>
<hr>
<h4 id="2512-architectural-flexibility-and-future-proofing" tabindex="-1">2.5.1.2 Architectural Flexibility and Future-Proofing</h4>
<p><strong>Model agnosticism.</strong> MCP is deliberately model-agnostic. The protocol defines how tools are described and invoked, but does not prescribe:</p>
<ul>
<li>Which LLM is used (GPT-4, Claude, Gemini, Llama, Mistral, or any future model)</li>
<li>How the LLM processes tool descriptions (system prompt injection, special tokens, etc.)</li>
<li>The LLM’s tool-calling format (the host translates between MCP tool definitions and the model’s native format)</li>
</ul>
<p>This means the same MCP server works regardless of model changes, upgrades, or migrations.</p>
<p><strong>Transport flexibility.</strong> The three-transport architecture (stdio, HTTP+SSE, Streamable HTTP) covers the full spectrum of deployment scenarios:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>deployment scenario</mtext><mo>↦</mo><mtext>optimal transport</mtext><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>local development, desktop apps</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>→</mo><mtext>stdio</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>cloud services, existing infrastructure</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>→</mo><mtext>HTTP+SSE</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>enterprise, production, load-balanced</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>→</mo><mtext>Streamable HTTP</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{deployment scenario} \mapsto \text{optimal transport} = \begin{cases}
\text{local development, desktop apps} &amp; \rightarrow \text{stdio} \\
\text{cloud services, existing infrastructure} &amp; \rightarrow \text{HTTP+SSE} \\
\text{enterprise, production, load-balanced} &amp; \rightarrow \text{Streamable HTTP}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">deployment scenario</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">optimal transport</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">local development, desktop apps</span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">cloud services, existing infrastructure</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">enterprise, production, load-balanced</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">stdio</span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">HTTP+SSE</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">Streamable HTTP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><p>New transport mechanisms can be added in future protocol versions without breaking existing implementations.</p>
<p><strong>Progressive capability adoption.</strong> Servers implement only the primitives they need:</p>
<ul>
<li>A simple calculator server: only <code>tools</code> capability.</li>
<li>A file browser server: <code>tools</code> + <code>resources</code> capabilities.</li>
<li>A sophisticated development server: <code>tools</code> + <code>resources</code> + <code>prompts</code> + <code>sampling</code> capabilities.</li>
</ul>
<p>This progressivity prevents the protocol from being “all or nothing” and allows incremental adoption.</p>
<p><strong>Version negotiation.</strong> The date-based versioning scheme and the negotiation handshake ensure that:</p>
<ul>
<li>Newer clients can work with older servers (graceful degradation to older feature set).</li>
<li>Newer servers can work with older clients (unknown capabilities are ignored).</li>
<li>Breaking changes are explicitly versioned, not silently introduced.</li>
</ul>
<p><strong>Abstraction stability.</strong> Because tool interfaces are defined at the MCP protocol level (name, description, JSON Schema), they remain stable even when the underlying implementation changes completely. A tool server can migrate from a REST API backend to a GraphQL backend, or from Python to Rust, without any change to the MCP interface.</p>
<p><strong>Multi-model architectures.</strong> A single MCP server can simultaneously serve tools to multiple different hosts using different models. This enables:</p>
<ul>
<li>A/B testing of different models with the same tool set</li>
<li>Ensemble architectures where multiple models collaborate via shared tools</li>
<li>Migration scenarios where old and new models run in parallel</li>
</ul>
<hr>
<h4 id="2513-foundations-for-governance-and-control" tabindex="-1">2.5.1.3 Foundations for Governance and Control</h4>
<p><strong>Centralized policy enforcement.</strong> The host-as-trust-boundary architecture provides a single point of control for:</p>
<table>
<thead>
<tr>
<th>Policy Type</th>
<th>Implementation Point</th>
<th>Mechanism</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tool approval</strong></td>
<td>Host</td>
<td>Consent dialog before destructive tool calls</td>
</tr>
<tr>
<td><strong>Rate limiting</strong></td>
<td>Host</td>
<td>Cap on tool calls per minute/session</td>
</tr>
<tr>
<td><strong>Data access</strong></td>
<td>Host</td>
<td>Filtering which resources are exposed to which servers</td>
</tr>
<tr>
<td><strong>Sampling approval</strong></td>
<td>Host</td>
<td>Review/modify sampling requests before execution</td>
</tr>
<tr>
<td><strong>Audit logging</strong></td>
<td>Host</td>
<td>Recording all tool calls, arguments, and results</td>
</tr>
<tr>
<td><strong>Cost control</strong></td>
<td>Host</td>
<td>Spending caps on API-backed tools</td>
</tr>
</tbody>
</table>
<p><strong>Tool annotation-driven policies.</strong> As formalized in §2.4.5.2, annotations enable automated policy decisions:</p>
<ul>
<li>Auto-approve <code>readOnlyHint: true</code> tools (no state change risk)</li>
<li>Require confirmation for <code>destructiveHint: true</code> tools</li>
<li>Allow automatic retry for <code>idempotentHint: true</code> tools</li>
<li>Apply enhanced monitoring for <code>openWorldHint: true</code> tools</li>
</ul>
<p><strong>Audit trail.</strong> The standardized JSON-RPC message format enables comprehensive audit logging:</p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T14:30:22Z&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;session_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sess-abc123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;direction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;client→server&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tools/call&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;delete_file&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;arguments&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/tmp/old-data.csv&quot;</span><span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;user_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user-456&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;approval&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user-confirmed&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;isError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;File deleted&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;latency_ms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</div><p>Every tool invocation, argument, result, approval decision, and timing can be logged in a standardized format across all tools and all hosts.</p>
<p><strong>Human-in-the-loop integration.</strong> The sampling and elicitation primitives explicitly encode human oversight into the protocol:</p>
<ul>
<li>Sampling requests can be presented to the user for review before execution.</li>
<li>Elicitation requests directly involve the user in the interaction loop.</li>
<li>The host can configure approval policies per tool, per server, or per user.</li>
</ul>
<p><strong>Scope limitation via roots.</strong> Roots provide an explicit mechanism for constraining server operations to defined boundaries, supporting the principle of least privilege at the workspace level.</p>
<hr>
<h3 id="252-critical-risks-and-challenges" tabindex="-1">2.5.2 Critical Risks and Challenges</h3>
<h4 id="2521-specification-maturity-and-stability" tabindex="-1">2.5.2.1 Specification Maturity and Stability</h4>
<p><strong>Rapid evolution risk.</strong> MCP’s specification is actively evolving, with the protocol version advancing through date-based releases (e.g., <code>2024-11-05</code> → <code>2025-03-26</code> → <code>2025-06-18</code>). Each release may introduce:</p>
<ul>
<li>New primitives (e.g., elicitation was added in later versions)</li>
<li>Modified message formats</li>
<li>Changed capability negotiation semantics</li>
<li>New transport specifications (Streamable HTTP was added after the initial spec)</li>
</ul>
<p>For production deployments, this means:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>maintenance_cost</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mn mathvariant="double-struck">1</mn><mo stretchy="false">[</mo><mtext>spec_change</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>⋅</mo><msub><mi>c</mi><mtext>update</mtext></msub><mtext> </mtext><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">
\text{maintenance\_cost}(t) = \int_0^T \mathbb{1}[\text{spec\_change}(t)] \cdot c_{\text{update}} \, dt
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">maintenance_cost</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5032em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5912em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mopen">[</span><span class="mord text"><span class="mord">spec_change</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">update</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span></eqn></section><p>where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn mathvariant="double-struck">1</mn><mo stretchy="false">[</mo><mtext>spec_change</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{1}[\text{spec\_change}(t)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord">1</span><span class="mopen">[</span><span class="mord text"><span class="mord">spec_change</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)]</span></span></span></span></eq>is an indicator for specification changes at time<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></eq>and<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext>update</mtext></msub></mrow><annotation encoding="application/x-tex">c_{\text{update}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">update</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq> is the cost of updating implementations.</p>
<p><strong>Underspecified areas.</strong> Several critical aspects remain insufficiently specified:</p>
<table>
<thead>
<tr>
<th>Area</th>
<th>Gap</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authentication</strong></td>
<td>No standard auth mechanism defined in the base protocol</td>
<td>Each server implements its own auth, breaking interoperability</td>
</tr>
<tr>
<td><strong>Authorization</strong></td>
<td>No RBAC, ABAC, or capability-based access control standard</td>
<td>No way to express “user X can call tool Y but not tool Z”</td>
</tr>
<tr>
<td><strong>Multi-tenancy</strong></td>
<td>No tenant isolation semantics defined</td>
<td>Shared servers cannot safely serve multiple organizations</td>
</tr>
<tr>
<td><strong>Error taxonomy</strong></td>
<td>Limited standard error codes beyond JSON-RPC defaults</td>
<td>Inconsistent error reporting across servers</td>
</tr>
<tr>
<td><strong>Content size limits</strong></td>
<td>No standard maximum payload sizes</td>
<td>Risk of oversized responses causing client failures</td>
</tr>
</tbody>
</table>
<p><strong>Conformance validation.</strong> As of the current state:</p>
<ul>
<li>No official conformance test suite exists.</li>
<li>Interoperability between different MCP SDK implementations (TypeScript vs. Python) may have subtle behavioral differences.</li>
<li>Edge case handling (malformed messages, unexpected disconnections, concurrent requests) varies across implementations.</li>
</ul>
<hr>
<h4 id="2522-complexity-overhead" tabindex="-1">2.5.2.2 Complexity Overhead</h4>
<p><strong>Abstraction layer cost.</strong> MCP adds an abstraction layer between the AI application and the tool. For use cases where a single model calls a single tool in a single application, this abstraction provides no benefit but adds:</p>
<table>
<thead>
<tr>
<th>Overhead</th>
<th>Source</th>
<th>Magnitude</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serialization</td>
<td>JSON-RPC encoding/decoding</td>
<td>~0.1-1ms per message</td>
</tr>
<tr>
<td>Transport</td>
<td>Process spawning (stdio) or HTTP round-trip</td>
<td>~1-100ms</td>
</tr>
<tr>
<td>Handshake</td>
<td><code>initialize</code> / <code>initialized</code> exchange</td>
<td>~10-500ms (one-time)</td>
</tr>
<tr>
<td>Tool listing</td>
<td><code>tools/list</code> request-response</td>
<td>~5-50ms per server</td>
</tr>
<tr>
<td>Context assembly</td>
<td>Converting MCP tool definitions to model format</td>
<td>~1-5ms</td>
</tr>
</tbody>
</table>
<p><strong>When MCP is overkill.</strong> MCP’s value proposition depends on the ecosystem context:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>value</mtext><mo stretchy="false">(</mo><mtext>MCP</mtext><mo stretchy="false">)</mo><mo>=</mo><munder><munder><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>M</mi><mo>+</mo><mi>N</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>M</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><mtext>avoided integrations</mtext></munder><mo>⋅</mo><msub><mi>c</mi><mtext>integration</mtext></msub><mo>−</mo><munder><munder><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><mtext>MCP implementations</mtext></munder><mo>⋅</mo><msub><mi>c</mi><mtext>MCP</mtext></msub><mo>−</mo><msub><mi>c</mi><mtext>overhead</mtext></msub><mo>⋅</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">
\text{value}(\text{MCP}) = \underbrace{(N-1) \cdot M + N \cdot (M-1)}_{\text{avoided integrations}} \cdot c_{\text{integration}} - \underbrace{(N + M)}_{\text{MCP implementations}} \cdot c_{\text{MCP}} - c_{\text{overhead}} \cdot T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">MCP</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4702em;vertical-align:-1.7202em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">avoided integrations</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7202em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">integration</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4702em;vertical-align:-1.7202em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP implementations</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7202em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">overhead</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span></eqn></section><p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>M</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N = 1, M = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></eq>: <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>value</mtext><mo>=</mo><mn>0</mn><mo>−</mo><mn>2</mn><mo>⋅</mo><msub><mi>c</mi><mtext>MCP</mtext></msub><mo>−</mo><msub><mi>c</mi><mtext>overhead</mtext></msub><mo>⋅</mo><mi>T</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{value} = 0 - 2 \cdot c_{\text{MCP}} - c_{\text{overhead}} \cdot T &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">overhead</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></eq>. MCP adds cost with no benefit.</p>
<p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>M</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">N = 1, M = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></eq>: marginal. The overhead may or may not be justified depending on tool complexity.</p>
<p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>5</mn><mo separator="true">,</mo><mi>M</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">N = 5, M = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span></eq>: strongly positive. The avoided integration cost (<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>⋅</mo><msub><mi>c</mi><mtext>integration</mtext></msub></mrow><annotation encoding="application/x-tex">100 \cdot c_{\text{integration}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">integration</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>reduced to<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>25</mn><mo>⋅</mo><msub><mi>c</mi><mtext>MCP</mtext></msub></mrow><annotation encoding="application/x-tex">25 \cdot c_{\text{MCP}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">25</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">MCP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>) dominates.</p>
<p><strong>Server lifecycle management.</strong> Operating MCP servers introduces operational complexity:</p>
<ul>
<li><strong>Process management</strong>: For stdio servers, the host must manage child process spawning, monitoring, and cleanup. Zombie processes, orphaned servers, and resource leaks are operational risks.</li>
<li><strong>Health monitoring</strong>: Periodic ping/pong, restart-on-failure policies, and alerting.</li>
<li><strong>Configuration management</strong>: Each server may require its own configuration (API keys, database credentials, feature flags).</li>
<li><strong>Dependency management</strong>: Servers may have their own runtime dependencies (Python virtualenvs, Node.js versions, system libraries).</li>
</ul>
<hr>
<h4 id="2523-performance-considerations" tabindex="-1">2.5.2.3 Performance Considerations</h4>
<p><strong>Serialization overhead.</strong> JSON-RPC messages require:</p>
<ol>
<li>Serialization (object → JSON string): CPU cost proportional to message size.</li>
<li>Transport (send bytes over pipe or network): I/O cost.</li>
<li>Deserialization (JSON string → object): CPU cost proportional to message size.</li>
</ol>
<p>For text-heavy tool results, this overhead is minimal. For binary-heavy results (images, audio), the Base64 encoding adds 33% size overhead:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>overhead</mtext><mtext>base64</mtext></msub><mo>=</mo><mfrac><mrow><msub><mtext>size</mtext><mtext>encoded</mtext></msub><mo>−</mo><msub><mtext>size</mtext><mtext>original</mtext></msub></mrow><msub><mtext>size</mtext><mtext>original</mtext></msub></mfrac><mo>=</mo><mfrac><mrow><mn>4</mn><mi mathvariant="normal">/</mi><mn>3</mn><mo>⋅</mo><mi>s</mi><mo>−</mo><mi>s</mi></mrow><mi>s</mi></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>≈</mo><mn>33</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">
\text{overhead}_{\text{base64}} = \frac{\text{size}_{\text{encoded}} - \text{size}_{\text{original}}}{\text{size}_{\text{original}}} = \frac{4/3 \cdot s - s}{s} = \frac{1}{3} \approx 33\%
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">overhead</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">base64</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.317em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3449em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">original</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">encoded</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">original</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4/3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">33%</span></span></span></span></span></eqn></section><p><strong>Context window consumption.</strong> MCP tool definitions consume context tokens. For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>servers with an average of<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>tools each, with average description length<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></eq> tokens:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>T</mi><mtext>tool_defs</mtext></msub><mo>=</mo><mi>M</mi><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">
T_{\text{tool\_defs}} = M \cdot k \cdot d
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tool_defs</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span></eqn></section><p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">M = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></eq>servers,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">k = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></eq>tools each,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">d = 150</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">150</span></span></span></span></eq>tokens per tool:<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>tool_defs</mtext></msub><mo>=</mo><mn>7,500</mn></mrow><annotation encoding="application/x-tex">T_{\text{tool\_defs}} = 7{,}500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tool_defs</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">7</span><span class="mord"><span class="mpunct">,</span></span><span class="mord">500</span></span></span></span></eq> tokens. This is a significant fraction of a 128K-token context window (~6%) and a very significant fraction of a 4K-token context window (~188%—exceeding the entire window).</p>
<p><strong>Mitigation strategies:</strong></p>
<ul>
<li><strong>Dynamic tool selection</strong>: Only inject tool definitions relevant to the current query.</li>
<li><strong>Tool description compression</strong>: Use concise descriptions optimized for token efficiency.</li>
<li><strong>Hierarchical tool namespaces</strong>: Present tool categories first; expand to individual tools on demand.</li>
<li><strong>Model-side tool caching</strong>: Some models support persistent tool definitions that don’t consume per-turn context tokens.</li>
</ul>
<p><strong>Latency comparison:</strong></p>
<table>
<thead>
<tr>
<th>Approach</th>
<th>Typical Latency</th>
<th>Components</th>
</tr>
</thead>
<tbody>
<tr>
<td>Direct function call (in-process)</td>
<td>~μs</td>
<td>Function dispatch</td>
</tr>
<tr>
<td>MCP via stdio</td>
<td>~1-10ms</td>
<td>Process IPC + JSON parse</td>
</tr>
<tr>
<td>MCP via HTTP (local)</td>
<td>~5-50ms</td>
<td>HTTP stack + JSON parse</td>
</tr>
<tr>
<td>MCP via HTTP (remote)</td>
<td>~10-500ms</td>
<td>Network RTT + HTTP stack + JSON parse</td>
</tr>
<tr>
<td>Direct API call (no MCP)</td>
<td>~10-500ms</td>
<td>Network RTT + HTTP stack + custom parse</td>
</tr>
</tbody>
</table>
<p>Note: For remote tools, MCP adds minimal overhead compared to a direct API call, since the network round-trip dominates. The overhead is most significant for local tools where a direct function call would be near-instantaneous.</p>
<hr>
<h4 id="2524-enterprise-readiness-gaps" tabindex="-1">2.5.2.4 Enterprise Readiness Gaps</h4>
<p><strong>Authentication and Authorization</strong></p>
<p>MCP’s base specification does not define a standard authentication or authorization mechanism. This is arguably the most significant gap for enterprise adoption.</p>
<p><strong>Current state:</strong></p>
<ul>
<li>OAuth 2.1 integration has been proposed in the specification and some SDKs, but adoption is inconsistent.</li>
<li>Most existing MCP servers rely on environment variables for API keys (e.g., <code>GITHUB_TOKEN</code>), which are:
<ul>
<li>Not dynamically rotatable</li>
<li>Not scoped to individual users</li>
<li>Not auditable</li>
<li>Shared across all sessions on a host</li>
</ul>
</li>
</ul>
<p><strong>Required capabilities for enterprise auth:</strong></p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Description</th>
<th>MCP Support</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>User-level authentication</strong></td>
<td>Each user authenticates to each server independently</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>Token rotation</strong></td>
<td>Credentials expire and are refreshed transparently</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>Scoped permissions</strong></td>
<td>Different users get different tool access on the same server</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>SSO integration</strong></td>
<td>Federated identity via SAML, OIDC</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>Credential isolation</strong></td>
<td>One server’s credentials are not accessible to other servers</td>
<td>Partially (client isolation)</td>
</tr>
</tbody>
</table>
<p><strong>Scalability Concerns</strong></p>
<p>The 1:1 client-server connection model creates scalability challenges:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>connections</mtext><mtext>total</mtext></msub><mo>=</mo><msub><mi>N</mi><mtext>users</mtext></msub><mo>×</mo><msub><mi>M</mi><mtext>servers</mtext></msub></mrow><annotation encoding="application/x-tex">
\text{connections}_{\text{total}} = N_{\text{users}} \times M_{\text{servers}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8179em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">connections</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">users</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">servers</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>For <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>users</mtext></msub><mo>=</mo><mn>1,000</mn></mrow><annotation encoding="application/x-tex">N_{\text{users}} = 1{,}000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">users</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mpunct">,</span></span><span class="mord">000</span></span></span></span></eq>concurrent users, each connecting to<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mtext>servers</mtext></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">M_{\text{servers}} = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">servers</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></eq>servers:<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10,000</mn></mrow><annotation encoding="application/x-tex">10{,}000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mord"><span class="mpunct">,</span></span><span class="mord">000</span></span></span></span></eq> concurrent connections. Each connection consumes:</p>
<ul>
<li>Server-side memory for session state</li>
<li>A process or thread (for stdio servers) or an HTTP connection (for remote servers)</li>
<li>Capability negotiation overhead at connection establishment</li>
</ul>
<p><strong>Scalability mitigation approaches (not yet standardized):</strong></p>
<ul>
<li>Connection pooling: Multiple users share a pool of server connections (requires session multiplexing, which MCP’s 1:1 model does not natively support).</li>
<li>Stateless server mode: Servers that don’t require per-session state could handle requests without persistent connections (partially supported by Streamable HTTP).</li>
<li>Server-side load balancing: Multiple instances of the same MCP server behind a load balancer, with session affinity via <code>Mcp-Session-Id</code>.</li>
</ul>
<p><strong>Monitoring and Observability</strong></p>
<p>Production MCP deployments require comprehensive observability, which is not yet standardized:</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Description</th>
<th>MCP Support</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Metrics</strong></td>
<td>Request rate, latency percentiles, error rates per tool/server</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>Distributed tracing</strong></td>
<td>Trace a user request through host → client → server → external API</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>Structured logging</strong></td>
<td>Standardized log format with correlation IDs</td>
<td>MCP defines <code>logging</code> capability but minimally</td>
</tr>
<tr>
<td><strong>Alerting</strong></td>
<td>Automated alerts on anomalies (error spikes, latency degradation)</td>
<td>Not standardized</td>
</tr>
<tr>
<td><strong>SLA management</strong></td>
<td>Availability and performance guarantees per server</td>
<td>Not standardized</td>
</tr>
</tbody>
</table>
<p><strong>Integration with OpenTelemetry</strong> (the de facto observability standard) would require:</p>
<ul>
<li>Propagating trace context (<code>traceparent</code> header) through MCP messages.</li>
<li>Emitting spans for each <code>tools/call</code> invocation with standardized attributes.</li>
<li>Recording metrics (histograms for latency, counters for calls) per tool.</li>
</ul>
<p>This integration is technically feasible but requires convention or specification-level standardization.</p>
<p><strong>Deployment and Operations</strong></p>
<table>
<thead>
<tr>
<th>Operational Concern</th>
<th>Challenge</th>
<th>Current State</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Server discovery</strong></td>
<td>How does a host find available MCP servers?</td>
<td>Manual configuration; no standard registry</td>
</tr>
<tr>
<td><strong>Configuration management</strong></td>
<td>How are server configs managed across environments?</td>
<td>Environment variables; no standard format</td>
</tr>
<tr>
<td><strong>Rolling updates</strong></td>
<td>How to update a server without disrupting active sessions?</td>
<td>Not addressed; sessions break on server restart</td>
</tr>
<tr>
<td><strong>Container orchestration</strong></td>
<td>How to run MCP servers in Kubernetes?</td>
<td>No standard patterns; community-developed</td>
</tr>
<tr>
<td><strong>Secret management</strong></td>
<td>How to securely provide API keys/credentials to servers?</td>
<td>Environment variables; no Vault/KMS integration standard</td>
</tr>
</tbody>
</table>
<p><strong>Container orchestration pattern (emerging practice):</strong></p>
<div class="code-shell"><pre class="hljs"><code class="hljs language-yaml"><span class="hljs-comment"># Example: MCP server as a Kubernetes deployment</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">github-mcp-server</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mcp-server</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">mcp-servers/github:v1.4</span>
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">8080</span>
        <span class="hljs-attr">env:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">GITHUB_TOKEN</span>
          <span class="hljs-attr">valueFrom:</span>
            <span class="hljs-attr">secretKeyRef:</span>
              <span class="hljs-attr">name:</span> <span class="hljs-string">github-credentials</span>
              <span class="hljs-attr">key:</span> <span class="hljs-string">token</span>
        <span class="hljs-attr">livenessProbe:</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/health</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
        <span class="hljs-attr">readinessProbe:</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/ready</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
</code></pre>
</div><p>This pattern is not standardized; each organization develops its own deployment conventions. Future MCP specification extensions or community standards may address these operational gaps.</p>
<hr>
<p><strong>Summary of MCP’s Position in the Maturity Curve:</strong></p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>MCP maturity</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>specification completeness</mtext><mo separator="true">,</mo><mtext>ecosystem size</mtext><mo separator="true">,</mo><mtext>enterprise readiness</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\text{MCP maturity} = f(\text{specification completeness}, \text{ecosystem size}, \text{enterprise readiness})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">MCP maturity</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">specification completeness</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">ecosystem size</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">enterprise readiness</span></span><span class="mclose">)</span></span></span></span></span></eqn></section><table>
<thead>
<tr>
<th>Dimension</th>
<th>Current State</th>
<th>Required for Production</th>
</tr>
</thead>
<tbody>
<tr>
<td>Core protocol</td>
<td>Mature (tools, resources, prompts)</td>
<td>✓</td>
</tr>
<tr>
<td>Transport layer</td>
<td>Mature (stdio, HTTP+SSE, Streamable HTTP)</td>
<td>✓</td>
</tr>
<tr>
<td>SDK support</td>
<td>Good (TypeScript, Python; others emerging)</td>
<td>✓</td>
</tr>
<tr>
<td>Authentication</td>
<td>Nascent (OAuth 2.1 proposed)</td>
<td>✗</td>
</tr>
<tr>
<td>Authorization</td>
<td>Absent</td>
<td>✗</td>
</tr>
<tr>
<td>Multi-tenancy</td>
<td>Absent</td>
<td>✗</td>
</tr>
<tr>
<td>Observability</td>
<td>Minimal</td>
<td>✗</td>
</tr>
<tr>
<td>Deployment patterns</td>
<td>Ad hoc</td>
<td>✗</td>
</tr>
<tr>
<td>Conformance testing</td>
<td>Absent</td>
<td>✗</td>
</tr>
<tr>
<td>Ecosystem size</td>
<td>Growing rapidly (100+ open-source servers)</td>
<td>✓</td>
</tr>
</tbody>
</table>
<p>MCP is architecturally sound and strategically well-positioned, but significant engineering effort remains to bridge the gap between its current state and enterprise-grade production readiness. Organizations adopting MCP today should treat it as a foundational protocol layer while building supplementary infrastructure for authentication, monitoring, and deployment on top of it.</p>

      </article>
      <section class="doc-pager" aria-label="Document pagination">
        <a class="pager-link" href="../../Agentic_ai/Task_decomposition_strategies.html"><small>Previous</small><strong>1.5 Task Decomposition Strategies</strong></a>
        <a class="pager-link" href="../../Agentic_ai/Tools/Introduction_Tools_Action.html"><small>Next</small><strong>Chapter 2: Tools — Comprehensive SOTA Reference</strong></a>
      </section>
      <footer class="doc-footer">
        <p>Generated from <code>llm_training_at_scale</code> at <time datetime="2026-02-19T19:13:56.962Z">2026-02-19T19:13:56.962Z</time>.</p>
      </footer>
    </main>
    <aside class="toc-pane">
      <p class="pane-label">On This Page</p>
      <nav class="toc-nav" aria-label="Table of contents">
<a class="toc-link toc-level-2" data-toc-link href="#24-understanding-the-model-context-protocol-mcp">2.4 Understanding the Model Context Protocol (MCP)</a>
<a class="toc-link toc-level-3" data-toc-link href="#241-the-n-m-integration-problem-and-the-need-for-standardization">2.4.1 The &quot;N × M&quot; Integration Problem and the Need for Standardization</a>
<a class="toc-link toc-level-4" data-toc-link href="#2411-the-combinatorial-explosion-problem">2.4.1.1 The Combinatorial Explosion Problem</a>
<a class="toc-link toc-level-4" data-toc-link href="#2412-pre-mcp-integration-landscape">2.4.1.2 Pre-MCP Integration Landscape</a>
<a class="toc-link toc-level-4" data-toc-link href="#2413-the-standardization-solution">2.4.1.3 The Standardization Solution</a>
<a class="toc-link toc-level-4" data-toc-link href="#2414-historical-precedents-for-standardization">2.4.1.4 Historical Precedents for Standardization</a>
<a class="toc-link toc-level-3" data-toc-link href="#242-core-architectural-components-hosts-clients-and-servers">2.4.2 Core Architectural Components: Hosts, Clients, and Servers</a>
<a class="toc-link toc-level-4" data-toc-link href="#2421-architecture-overview">2.4.2.1 Architecture Overview</a>
<a class="toc-link toc-level-4" data-toc-link href="#2422-host">2.4.2.2 Host</a>
<a class="toc-link toc-level-4" data-toc-link href="#2423-client">2.4.2.3 Client</a>
<a class="toc-link toc-level-4" data-toc-link href="#2424-server">2.4.2.4 Server</a>
<a class="toc-link toc-level-4" data-toc-link href="#2425-capability-negotiation">2.4.2.5 Capability Negotiation</a>
<a class="toc-link toc-level-3" data-toc-link href="#243-the-communication-layer-json-rpc-transports-and-message-types">2.4.3 The Communication Layer: JSON-RPC, Transports, and Message Types</a>
<a class="toc-link toc-level-4" data-toc-link href="#2431-json-rpc-20-as-the-wire-protocol">2.4.3.1 JSON-RPC 2.0 as the Wire Protocol</a>
<a class="toc-link toc-level-4" data-toc-link href="#2432-transport-mechanisms">2.4.3.2 Transport Mechanisms</a>
<a class="toc-link toc-level-4" data-toc-link href="#2433-message-types-in-detail">2.4.3.3 Message Types in Detail</a>
<a class="toc-link toc-level-4" data-toc-link href="#2434-session-management-and-stateful-connections">2.4.3.4 Session Management and Stateful Connections</a>
<a class="toc-link toc-level-3" data-toc-link href="#244-key-primitives-tools-and-others">2.4.4 Key Primitives: Tools and Others</a>
<a class="toc-link toc-level-4" data-toc-link href="#2441-primitives-overview">2.4.4.1 Primitives Overview</a>
<a class="toc-link toc-level-4" data-toc-link href="#2442-design-philosophy">2.4.4.2 Design Philosophy</a>
<a class="toc-link toc-level-3" data-toc-link href="#245-tool-definition-mcp">2.4.5 Tool Definition (MCP)</a>
<a class="toc-link toc-level-4" data-toc-link href="#2451-tool-definition-schema">2.4.5.1 Tool Definition Schema</a>
<a class="toc-link toc-level-4" data-toc-link href="#2452-tool-annotations-and-metadata">2.4.5.2 Tool Annotations and Metadata</a>
<a class="toc-link toc-level-4" data-toc-link href="#2453-tool-listing-protocol">2.4.5.3 Tool Listing Protocol</a>
<a class="toc-link toc-level-4" data-toc-link href="#2454-input-schema-design-for-mcp-tools">2.4.5.4 Input Schema Design for MCP Tools</a>
<a class="toc-link toc-level-3" data-toc-link href="#246-tool-results">2.4.6 Tool Results</a>
<a class="toc-link toc-level-4" data-toc-link href="#2461-result-structure">2.4.6.1 Result Structure</a>
<a class="toc-link toc-level-4" data-toc-link href="#2462-content-types-in-results">2.4.6.2 Content Types in Results</a>
<a class="toc-link toc-level-4" data-toc-link href="#2463-result-semantics">2.4.6.3 Result Semantics</a>
<a class="toc-link toc-level-3" data-toc-link href="#247-structured-content">2.4.7 Structured Content</a>
<a class="toc-link toc-level-4" data-toc-link href="#2471-multi-modal-content-representation">2.4.7.1 Multi-Modal Content Representation</a>
<a class="toc-link toc-level-4" data-toc-link href="#2472-content-annotations">2.4.7.2 Content Annotations</a>
<a class="toc-link toc-level-3" data-toc-link href="#248-error-handling">2.4.8 Error Handling</a>
<a class="toc-link toc-level-4" data-toc-link href="#2481-error-levels-in-mcp">2.4.8.1 Error Levels in MCP</a>
<a class="toc-link toc-level-4" data-toc-link href="#2482-error-reporting-for-tool-execution">2.4.8.2 Error Reporting for Tool Execution</a>
<a class="toc-link toc-level-4" data-toc-link href="#2483-retry-and-recovery-strategies">2.4.8.3 Retry and Recovery Strategies</a>
<a class="toc-link toc-level-3" data-toc-link href="#249-other-capabilities">2.4.9 Other Capabilities</a>
<a class="toc-link toc-level-4" data-toc-link href="#2491-resources">2.4.9.1 Resources</a>
<a class="toc-link toc-level-4" data-toc-link href="#2492-prompts">2.4.9.2 Prompts</a>
<a class="toc-link toc-level-4" data-toc-link href="#2493-sampling">2.4.9.3 Sampling</a>
<a class="toc-link toc-level-4" data-toc-link href="#2494-elicitation">2.4.9.4 Elicitation</a>
<a class="toc-link toc-level-4" data-toc-link href="#2495-roots">2.4.9.5 Roots</a>
<a class="toc-link toc-level-2" data-toc-link href="#25-model-context-protocol-for-and-against">2.5 Model Context Protocol: For and Against</a>
<a class="toc-link toc-level-3" data-toc-link href="#251-capabilities-and-strategic-advantages">2.5.1 Capabilities and Strategic Advantages</a>
<a class="toc-link toc-level-4" data-toc-link href="#2511-accelerating-development-and-fostering-a-reusable-ecosystem">2.5.1.1 Accelerating Development and Fostering a Reusable Ecosystem</a>
<a class="toc-link toc-level-4" data-toc-link href="#2512-architectural-flexibility-and-future-proofing">2.5.1.2 Architectural Flexibility and Future-Proofing</a>
<a class="toc-link toc-level-4" data-toc-link href="#2513-foundations-for-governance-and-control">2.5.1.3 Foundations for Governance and Control</a>
<a class="toc-link toc-level-3" data-toc-link href="#252-critical-risks-and-challenges">2.5.2 Critical Risks and Challenges</a>
<a class="toc-link toc-level-4" data-toc-link href="#2521-specification-maturity-and-stability">2.5.2.1 Specification Maturity and Stability</a>
<a class="toc-link toc-level-4" data-toc-link href="#2522-complexity-overhead">2.5.2.2 Complexity Overhead</a>
<a class="toc-link toc-level-4" data-toc-link href="#2523-performance-considerations">2.5.2.3 Performance Considerations</a>
<a class="toc-link toc-level-4" data-toc-link href="#2524-enterprise-readiness-gaps">2.5.2.4 Enterprise Readiness Gaps</a>
      </nav>
    </aside>
  </div>
  <script type="module" src="../../assets/app.js?v=2026-02-19T19%3A13%3A56.962Z"></script>
</body>
</html>